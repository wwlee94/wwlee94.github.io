{"componentChunkName":"component---src-templates-post-tsx","path":"/category/spring/toby-spring/aop/unittest-and-proxy/","result":{"data":{"site":{"siteMetadata":{"title":"Blausee 기술 블로그","author":"wwlee94","siteUrl":"https://wwlee94.github.io"}},"markdownRemark":{"id":"47d655ed-b77d-5309-af68-8bf84162fc8a","excerpt":"개요 는 , 와 더불어 스프링의 3개 기반기술의 하나입니다. 스프링에 적용된 가장 인기 있는 의 적용 대상은 바로 선언적 트랜잭션 기능입니다. 이번 포스팅에서는 서비스 추상화로 많은 근본적인 문제를 해결했던 트랜잭션 경계 설정 기능을 를 이용해 더 깔끔한 방식으로 바꿔보겠습니다.…","html":"<h2 id=\"개요\" style=\"position:relative;\"><a href=\"#%EA%B0%9C%EC%9A%94\" aria-label=\"개요 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>개요</h2>\n<p><code class=\"language-text\">AOP</code>는 <code class=\"language-text\">IoC/DI</code>, <code class=\"language-text\">서비스 추상화</code>와 더불어 스프링의 3개 기반기술의 하나입니다.</p>\n<p>스프링에 적용된 가장 인기 있는 <code class=\"language-text\">AOP</code>의 적용 대상은 바로 선언적 트랜잭션 기능입니다.</p>\n<p>이번 포스팅에서는 서비스 추상화로 많은 근본적인 문제를 해결했던 트랜잭션 경계 설정 기능을 <code class=\"language-text\">AOP</code>를 이용해 더 깔끔한 방식으로 바꿔보겠습니다.</p>\n<h2 id=\"1-트랜잭션-코드의-분리\" style=\"position:relative;\"><a href=\"#1-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%BD%94%EB%93%9C%EC%9D%98-%EB%B6%84%EB%A6%AC\" aria-label=\"1 트랜잭션 코드의 분리 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 트랜잭션 코드의 분리</h2>\n<p>여러 기술과 환경에 독립적인 깔끔한 UserService 코드이지만, 한가지 찜찜한 문제가 있습니다.<br>\n바로 트랜잭션 경계설정 부분입니다.</p>\n<p><strong>트랜잭션과 비즈니스 로직이 공존하는 메소드</strong></p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">upgradeLevels</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 트랜잭션 전 처리</span>\n    <span class=\"token class-name\">PlatformTransactionManager</span> transactionManager\n        <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DataSourceTransactionManager</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">TransactionStatus</span> status <span class=\"token operator\">=</span>\n        transactionManager<span class=\"token punctuation\">.</span><span class=\"token function\">getTransaction</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">DefaultTransactionDefinition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 비즈니스 로직</span>\n        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> users <span class=\"token operator\">=</span> userDao<span class=\"token punctuation\">.</span><span class=\"token function\">getAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span> user <span class=\"token operator\">:</span> users<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">canUpgradeLevel</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">upgradeUser</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token comment\">// 트랜잭션 후 처리</span>\n        transactionManager<span class=\"token punctuation\">.</span><span class=\"token function\">commit</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        transactionManager<span class=\"token punctuation\">.</span><span class=\"token function\">rollback</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">throw</span> e<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>비즈니스 로직 코드를 사이에 두고 트랜잭션 시작과 종료를 담당하는 코드가 전후로 존재합니다.<br>\nUserService 클래스에서는 비즈니스 로직만 담는 것이 이상적인 설계입니다.</p>\n<h4 id=\"1-di를-이용한-클래스의-분리\" style=\"position:relative;\"><a href=\"#1-di%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%ED%81%B4%EB%9E%98%EC%8A%A4%EC%9D%98-%EB%B6%84%EB%A6%AC\" aria-label=\"1 di를 이용한 클래스의 분리 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1) DI를 이용한 클래스의 분리</h4>\n<p>그렇다면, <code class=\"language-text\">트랜잭션 처리 부분을 분리</code>하는 것은 어떨까?!</p>\n<p>현재 UserService는 클래스로 되어있어 다른 코드에서 사용한다면 UserService를 직접 참조하게 되어 <code class=\"language-text\">강한 결합도</code>를 가지게 됩니다.<br>\n따라서, 이전에 계속 반복했던 <code class=\"language-text\">인터페이스</code>를 활용하여 강한 결합도를 분리합니다.</p>\n<p>또한, UserService의 비즈니스 처리 구현체인 UserServiceImpl과 트랜잭션 구현체인 UserServiceTx 2가지 클래스를 만듭니다.</p>\n<ul>\n<li>UserServiceImpl: UserService의 순수한 비즈니스 로직 구현체</li>\n<li>UserServiceTx : 트랜잭션 처리 책임을 맡고 있는 구현체</li>\n</ul>\n<p>앞서 말한 구조는 다음과 같습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.4468085106383%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA0ElEQVQY002RiQqAQAhE9///MSKikz267zKesJEwtKgzjmacczLPs9R1LW3byjRN0nWdPM8jxH3f0ve9oigKBfUQgsSIvYSJzVmWSZ7nMo6jEoZhkH3fdYi1VoXTNJUkSTQfgtf8siwKjPA13vvPXQSC53mqyHEcOhBCVVVSluW3BT3XdX3AjOEB8Q9EyEPgHIBmhnMi3tERvVFYHbL/HxRwxI1wi3tWc85qDQFq/81wGweZvzMEIVCAxA9gzaZpdAiC27apE0SoI8q96V/XVV7LYs2Bg+RoMwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AOP 1\"\n        title=\"AOP 1\"\n        src=\"/static/6fea5fb6c8dd964e659fa5ce9db808c6/1d69c/AOP-1.png\"\n        srcset=\"/static/6fea5fb6c8dd964e659fa5ce9db808c6/4dcb9/AOP-1.png 188w,\n/static/6fea5fb6c8dd964e659fa5ce9db808c6/5ff7e/AOP-1.png 375w,\n/static/6fea5fb6c8dd964e659fa5ce9db808c6/1d69c/AOP-1.png 750w,\n/static/6fea5fb6c8dd964e659fa5ce9db808c6/7ae9c/AOP-1.png 972w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<h4 id=\"2-분리된-트랜잭션-기능\" style=\"position:relative;\"><a href=\"#2-%EB%B6%84%EB%A6%AC%EB%90%9C-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EA%B8%B0%EB%8A%A5\" aria-label=\"2 분리된 트랜잭션 기능 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2) 분리된 트랜잭션 기능</h4>\n<p><strong>UserService 인터페이스</strong></p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">UserService</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">void</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span> user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">void</span> <span class=\"token function\">upgradeLevels</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>트랜잭션 코드를 제거한 UserService 구현 클래스</strong></p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UserServiceImpl</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">UserService</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">upgradeLevels</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> users <span class=\"token operator\">=</span> userDao<span class=\"token punctuation\">.</span><span class=\"token function\">getAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span> user <span class=\"token operator\">:</span> users<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">canUpgradeLevel</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">upgradeLevel</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>위임 기능을 가진 UserServiceTx 트랜잭션 클래스</strong></p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UserServiceTx</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span> user<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        userService<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">upgradeLevels</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">TransactionStatus</span> status <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>transactionManager\n            <span class=\"token punctuation\">.</span><span class=\"token function\">getTransaction</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">DefaultTransactionDefinition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n            userService<span class=\"token punctuation\">.</span><span class=\"token function\">upgradeLevels</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>transactionManager<span class=\"token punctuation\">.</span><span class=\"token function\">commit</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">RuntimeException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>transactionManager<span class=\"token punctuation\">.</span><span class=\"token function\">rollback</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">throw</span> e<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>트랜잭션 로직의 <code class=\"language-text\">역할</code>은 비즈니스 로직 처리 전후로 <code class=\"language-text\">트랜잭션 경계설정</code>을 해주고 실행될 비즈니스 로직을 <code class=\"language-text\">위임하는 역할</code>입니다.<br>\n이제 비즈니스 로직과 트랜잭션 로직 처리 코드가 깔끔하게 분리되었습니다.</p>\n<h4 id=\"3-트랜잭션-적용을-위한-di-설정\" style=\"position:relative;\"><a href=\"#3-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%A0%81%EC%9A%A9%EC%9D%84-%EC%9C%84%ED%95%9C-di-%EC%84%A4%EC%A0%95\" aria-label=\"3 트랜잭션 적용을 위한 di 설정 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3) 트랜잭션 적용을 위한 DI 설정</h4>\n<p>기본적으로 <code class=\"language-text\">@Autowired</code>는 타입이 일치하는 빈을 가져오는데 현재는 UserService를 구현한 두 개의 빈이 존재합니다.<br>\n그렇기에 Spring의 DI기능을 사용하기 위해서는 같은 타입의 빈을 구별할 수 있도록 필드 이름을 수정해주어야합니다.</p>\n<p>DI 규칙은 다음과 같습니다.</p>\n<ol>\n<li>스프링 컨테이너가 같은 <code class=\"language-text\">Class Type</code>으로 빈을 찾습니다.</li>\n<li><code class=\"language-text\">Class Type</code>이 중복된다면, <code class=\"language-text\">필드명</code>으로 빈을 찾습니다.</li>\n</ol>\n<h4 id=\"4-트랜잭션-처리-코드-분리의-장점\" style=\"position:relative;\"><a href=\"#4-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%B2%98%EB%A6%AC-%EC%BD%94%EB%93%9C-%EB%B6%84%EB%A6%AC%EC%9D%98-%EC%9E%A5%EC%A0%90\" aria-label=\"4 트랜잭션 처리 코드 분리의 장점 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4) 트랜잭션 처리 코드 분리의 장점</h4>\n<p>비즈니스 코드와 트랜잭션 처리 코드를 분리했을 때의 <code class=\"language-text\">장점</code>은 다음과 같습니다.</p>\n<ul>\n<li>비즈니스 로직을 담당하는 코드를 작성할 때는 트랜잭션과 관련된 내용에 대해 신경쓰지 않아도 됩니다.</li>\n<li>비즈니스 로직에 대한 테스트 코드를 작성하기 쉬워집니다.</li>\n</ul>\n<h2 id=\"2-고립된-단위-테스트\" style=\"position:relative;\"><a href=\"#2-%EA%B3%A0%EB%A6%BD%EB%90%9C-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"2 고립된 단위 테스트 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 고립된 단위 테스트</h2>\n<p>가장 편하고 좋은 테스트 방법은 <code class=\"language-text\">가능한 한 작은 단위</code>로 쪼개서 테스트하는 것입니다.<br>\n작은 단위의 테스트가 좋은 이유는 테스트가 실패했을 때 그 <code class=\"language-text\">원인</code>을 찾기 쉬워지기 때문입니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.4468085106383%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAzklEQVQY03WQWQqEQAxEvf/VxCuI2O477oqamRdpcT4mUCR0J1WpONd1yb/Y912MMV9EmvM8lyiKJAgCSdNUyrLUmvdpmnTGOc9ThmGQvu8V8zxLXdeKOI4lDEMdyLJMiqLQDJjZtk2JmAEPYVVVkiSJqtIIieu64nme1vxBbkKjeVkWOY5DHVCP46hQQiy/QdBMY9u2D+EteIuyKWiaRi0j0nXdLyGbvrMNLHErXJCx7/u+CmGdd86DfeYcS/IPNqzIuq5qDyHOgxv7T/8Ha3TMDo2oxl4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AOP 2\"\n        title=\"AOP 2\"\n        src=\"/static/17a7b72c61740780287de25d4bfdc4c3/1d69c/AOP-2.png\"\n        srcset=\"/static/17a7b72c61740780287de25d4bfdc4c3/4dcb9/AOP-2.png 188w,\n/static/17a7b72c61740780287de25d4bfdc4c3/5ff7e/AOP-2.png 375w,\n/static/17a7b72c61740780287de25d4bfdc4c3/1d69c/AOP-2.png 750w,\n/static/17a7b72c61740780287de25d4bfdc4c3/78797/AOP-2.png 1125w,\n/static/17a7b72c61740780287de25d4bfdc4c3/c1b63/AOP-2.png 1200w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>하지만, 위의 그림처럼 여러 의존 관계를 가진 객체들이 존재하기에 원하는 대로 쪼갤 수 없는 경우가 있습니다.</p>\n<p>UserServiceTest는 오직 UserService의 기능만을 테스트하기 위한 테스트입니다.<br>\n하지만, 여러 의존 객체가 있어서 불필요한 리소스가 들고 UserService에는 문제가 없더라도 다른 의존 객체에 문제가 생겨 테스트에 실패할 수도 있습니다.</p>\n<h4 id=\"1-테스트-대상-고립시키기\" style=\"position:relative;\"><a href=\"#1-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EB%8C%80%EC%83%81-%EA%B3%A0%EB%A6%BD%EC%8B%9C%ED%82%A4%EA%B8%B0\" aria-label=\"1 테스트 대상 고립시키기 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1) 테스트 대상 고립시키기</h4>\n<p>테스트 대상을 고립(의존성을 제거)시키길 원한다면, MailSender에 적용했던 것 처럼 <code class=\"language-text\">목 오브젝트</code>를 만들어 검증하는 방법을 이용하면 됩니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.4468085106383%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA7klEQVQY011R2Q6DMAzj/78OIR4RRzlbbiiHxJHNRpumIUUJqWs7qXPftyCu62Je11WWZWFmbRexs2W9bZtM08Q8z7P0fc//fd955zgOcc7zJNknrLUEoB7HUbTWkue5xHEsURSx7rpOyrJkryiKrwmEU9e1pGnKAAjZdV3xfV88z5MgCAiEE7gahoFCxhiKISdJQhESgh1ABBoAV1VFZQTAEIKzLMt4hssgQq9pmjcu5/gklL/vcQMB+64fMRCGYcgRIYAeiCGAM2QIkPB3f3gULFaplPtSSnFEjKu1EawH7rr+cQhXOG/bln081guKr8csafvRzgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AOP 3\"\n        title=\"AOP 3\"\n        src=\"/static/a3f73f24511e235fa358fbe75264404e/1d69c/AOP-3.png\"\n        srcset=\"/static/a3f73f24511e235fa358fbe75264404e/4dcb9/AOP-3.png 188w,\n/static/a3f73f24511e235fa358fbe75264404e/5ff7e/AOP-3.png 375w,\n/static/a3f73f24511e235fa358fbe75264404e/1d69c/AOP-3.png 750w,\n/static/a3f73f24511e235fa358fbe75264404e/8ae78/AOP-3.png 1096w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><strong>UserDao 목 오브젝트</strong></p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MockUserDao</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">UserDao</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> users<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> updated <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MockUserDao</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> users<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>users <span class=\"token operator\">=</span> users<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">getAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>users<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span> user<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>updated<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">getUpdated</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> updated<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// 테스트에 사용되지 않는 메소드</span>\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span> user<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UnsupportedOperationException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">User</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UnsupportedOperationException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"2-고립-단위-테스팅의-장점\" style=\"position:relative;\"><a href=\"#2-%EA%B3%A0%EB%A6%BD-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8C%85%EC%9D%98-%EC%9E%A5%EC%A0%90\" aria-label=\"2 고립 단위 테스팅의 장점 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2) 고립 단위 테스팅의 장점</h4>\n<ul>\n<li>테스트만을 위해 완전히 독립적으로 동작하는 테스트 대상을 사용하기 때문에 스프링 컨테이너에서 빈을 가져올 필요가 없습니다.</li>\n<li>DB 연동, 실행 &#x26; 메일 서버 등을 이용하지 않으므로 테스트의 수행 성능이 향상됩니다.</li>\n</ul>\n<h4 id=\"3-단위-테스트와-통합-테스트\" style=\"position:relative;\"><a href=\"#3-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%99%80-%ED%86%B5%ED%95%A9-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"3 단위 테스트와 통합 테스트 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3) 단위 테스트와 통합 테스트</h4>\n<p>이처럼 테스트 대상 클래스를 목 오브젝트 등의 테스트 대역을 사용해 의존 오브젝트나 외부의 리소스를 사용하지 않도록 고립시키는 테스트를 <code class=\"language-text\">단위 테스트</code>라고 합니다.</p>\n<p>반면에, 다른 오브젝트가 연동하도록 만들어 테스트하거나, 외부의 DB나 파일, 서비스 등의 리소스가 참여하는 테스트를 <code class=\"language-text\">통합 테스트</code>라고 합니다.</p>\n<h4 id=\"4-목-프레임워크\" style=\"position:relative;\"><a href=\"#4-%EB%AA%A9-%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC\" aria-label=\"4 목 프레임워크 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4) 목 프레임워크</h4>\n<p>단위 테스트를 만들기 위해서는 스텁이나 목 오브젝트의 사용이 필수적입니다.<br>\n단위 테스트가 많은 장점을 지니고 가장 우선시해야 할 테스트 방법이지만 작성이 번거롭다는 단점이 있습니다.<br>\n이러한 단점을 해결해주도록 도와주는 다양한 목 오브젝트 프레임워크가 있습니다.</p>\n<p><strong>Mockito 프레임워크</strong></p>\n<p>Mockito와 같은 목 프레임워크의 특징은 목 클래스를 일일이 준비해둘 필요가 없다는 점입니다.<br>\n간단한 메소드 호출만으로 다이내믹하게 특정 인터페이스를 구현한 테스트용 목 오브젝트를 생성할 수 있습니다.</p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token class-name\">UserDao</span> mockUserDao <span class=\"token operator\">=</span> <span class=\"token function\">mock</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UserDao</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<blockquote>\n<p>mock() 메소드는 org.mockito.Matchers 클래스에 정의된 스태틱 메소드</p>\n</blockquote>\n<p><code class=\"language-text\">getAll()</code> 메소드가 불려올 때 사용자 목록을 리턴하도록 스텁 기능을 추가해주고 싶다면 다음의 코드면 충분합니다.</p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token function\">when</span><span class=\"token punctuation\">(</span>mockUserDao<span class=\"token punctuation\">.</span><span class=\"token function\">getAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">thenReturn</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span> <span class=\"token punctuation\">.</span>users<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>또한, Mockito를 통해 만들어진 목 오브젝트는 메소드의 호출과 관련된 모든 내용을 자동으로 저장해두고, 이를 간단한 메소드로 검증할 수 있게 해줍니다.</p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token function\">verify</span><span class=\"token punctuation\">(</span>mockUserDao<span class=\"token punctuation\">,</span> <span class=\"token function\">times</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token function\">any</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Mockito 목 오브젝트는 아래의 4 단계를 거칩니다.</p>\n<ul>\n<li>인터페이스를 이용해 목 오브젝트를 만든다.</li>\n<li>목 오브젝트가 리턴할 값이 있으면 이를 지정해준다. 메소드가 호출되면 예외를 강제로 던지게 만들수도 있다.</li>\n<li>테스트 대상 오브젝트에 DI 해서 목 오브젝트가 테스트 중에 사용되도록 만든다.</li>\n<li>테스트 대상 오브젝트를 사용한 후에 목 오브젝트의 특정 메소드가 호출됐는지, 어떤 값을 가지고 몇 번 호출됐는지를 검증한다.</li>\n</ul>\n<h2 id=\"3-다이내믹-프록시와-팩토리-빈\" style=\"position:relative;\"><a href=\"#3-%EB%8B%A4%EC%9D%B4%EB%82%B4%EB%AF%B9-%ED%94%84%EB%A1%9D%EC%8B%9C%EC%99%80-%ED%8C%A9%ED%86%A0%EB%A6%AC-%EB%B9%88\" aria-label=\"3 다이내믹 프록시와 팩토리 빈 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 다이내믹 프록시와 팩토리 빈</h2>\n<h4 id=\"1-프록시\" style=\"position:relative;\"><a href=\"#1-%ED%94%84%EB%A1%9D%EC%8B%9C\" aria-label=\"1 프록시 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1) 프록시</h4>\n<p>트랜잭션이라는 기능은 비즈니스 로직과는 성격이 다르기 때문에 밖으로 분리할 수 있습니다.<br>\n트랜잭션 같은 부가기능은 원래 핵심기능을 가진 클래스로 <code class=\"language-text\">위임</code>해줘야 합니다.<br>\n즉, <code class=\"language-text\">부가기능이 핵심기능을 사용하는 구조</code>가 되는것입니다.</p>\n<p>문제는 이렇게 구성했더라도 클라이언트가 핵심 기능을 가진 클래스를 직접 사용해버리면 부가기능이 적용될 기회가 없습니다.<br>\n그래서 클라이언트는 <code class=\"language-text\">인터페이스</code>를 통해서만 핵심기능을 사용하게 하고, 부가기능 자신도 같은 <code class=\"language-text\">인터페이스</code>를 구현한 뒤에 자신이 그 사이에 끼어드는 구조를 만들어야합니다.</p>\n<p>이런 구조가 <code class=\"language-text\">프록시</code>입니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.02127659574468%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAkUlEQVQI1zVO2wqFIBDs/z/RDMqkHtLCW0WGc5qFszAoszuXLqUE5xy01liWBSEEwX3fH+9hjBGM44i+7+G9x/M8ohmGAdZaebmnriulgHNdF2qteN8XDGmtiWhdV0zTJIHzPGPbNhzHIRx3Sikx5J/3HV1pep6nIMYo5pyc8xdQZf9vRo435BjOgH3fpQyL/AAKjuL/C+OYqAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AOP 4\"\n        title=\"AOP 4\"\n        src=\"/static/a22edb4252fe9629154cf8aef27eb824/1d69c/AOP-4.png\"\n        srcset=\"/static/a22edb4252fe9629154cf8aef27eb824/4dcb9/AOP-4.png 188w,\n/static/a22edb4252fe9629154cf8aef27eb824/5ff7e/AOP-4.png 375w,\n/static/a22edb4252fe9629154cf8aef27eb824/1d69c/AOP-4.png 750w,\n/static/a22edb4252fe9629154cf8aef27eb824/f53a0/AOP-4.png 1062w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<ul>\n<li>프록시 : 마치 자신이 클라이언트가 사용하려고 하는 실제 대상인 것처럼 위장해서 클라이언트의 요청을 받아주는 것을 대리자, 대리인과 같은 역할 (UserServiceTx)</li>\n<li>타깃 : 프록시를 통해 최종적으로 요청을 위임받아 처리하는 실제 오브젝트 (UserServiceImpl)</li>\n</ul>\n<p>프록시는 사용 목적에 따라 2가지로 분류할 수 있습니다.</p>\n<ol>\n<li>클라이언트가 타깃에 접근하는 방법을 제어하기 위해서</li>\n<li>타깃에 부가적인 기능을 부여해주기 위해서</li>\n</ol>\n<h4 id=\"2-데코레이터-패턴\" style=\"position:relative;\"><a href=\"#2-%EB%8D%B0%EC%BD%94%EB%A0%88%EC%9D%B4%ED%84%B0-%ED%8C%A8%ED%84%B4\" aria-label=\"2 데코레이터 패턴 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2) 데코레이터 패턴</h4>\n<p><code class=\"language-text\">데코레이터 패턴</code>은 타깃에 부가적인 기능을 런타임 시 다이내믹하게 부여해주기 위해 프록시를 사용하는 패턴입니다.<br>\n‘다이내믹하게 기능을 부가한다’는 의미는 코드상에서는 ‘어떤 방법과 순서로 프록시와 타깃이 사용되는지 정해져 있지 않다’는 뜻입니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.808510638297875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAEABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdu4SD//xAAWEAADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQEAAQUCIv/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cf//EABgQAQEAAwAAAAAAAAAAAAAAAAEAESGB/9oACAEBAAE/IV3i6gv/2gAMAwEAAgADAAAAEAAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxAAAgMAAwAAAAAAAAAAAAAAAREAITFRYZH/2gAIAQEAAT8QLlRPcRm/UQ7O8z//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AOP 5\"\n        title=\"AOP 5\"\n        src=\"/static/3d7dff582febf0c1d47de073d28c2fe6/acb04/AOP-5.jpg\"\n        srcset=\"/static/3d7dff582febf0c1d47de073d28c2fe6/bc01b/AOP-5.jpg 188w,\n/static/3d7dff582febf0c1d47de073d28c2fe6/bf173/AOP-5.jpg 375w,\n/static/3d7dff582febf0c1d47de073d28c2fe6/acb04/AOP-5.jpg 750w,\n/static/3d7dff582febf0c1d47de073d28c2fe6/ec605/AOP-5.jpg 1125w,\n/static/3d7dff582febf0c1d47de073d28c2fe6/c58a3/AOP-5.jpg 1500w,\n/static/3d7dff582febf0c1d47de073d28c2fe6/cd36b/AOP-5.jpg 3525w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>자바 IO 패키지의 <code class=\"language-text\">InputStream</code>과 <code class=\"language-text\">OutputStream</code> 이 데코레이터 패턴의 대표적인 예입니다.</p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token class-name\">InputStream</span> is <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BufferedInputStream</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">FileInputStream</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a.txt\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>이러한 <code class=\"language-text\">데코레이터 패턴</code>은 타깃의 코드에 <code class=\"language-text\">손대지 않고</code>, 클라이언트가 호출하는 방법도 <code class=\"language-text\">변경하지 않은 채</code>로 <code class=\"language-text\">새로운 기능을 추가</code>할 때 유용한 방법입니다.</p>\n<h4 id=\"3-프록시-패턴\" style=\"position:relative;\"><a href=\"#3-%ED%94%84%EB%A1%9D%EC%8B%9C-%ED%8C%A8%ED%84%B4\" aria-label=\"3 프록시 패턴 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3) 프록시 패턴</h4>\n<p><code class=\"language-text\">프록시 패턴</code>의 프록시는 기존코드에 영향을 주지 않으면서 타깃의 기능을 확장하거나 <code class=\"language-text\">접근 방법을 제어</code>할 수 있는 유용한 방법입니다.</p>\n<h5 id=\"프록시-구성과-역할\" style=\"position:relative;\"><a href=\"#%ED%94%84%EB%A1%9D%EC%8B%9C-%EA%B5%AC%EC%84%B1%EA%B3%BC-%EC%97%AD%ED%95%A0\" aria-label=\"프록시 구성과 역할 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>프록시 구성과 역할</h5>\n<ul>\n<li>프록시는 타깃과 같은 기능을 구현하고 있다가 메소드가 호출되면 타깃 오브젝트로 위임합니다.</li>\n<li>또한, 지정된 특정 요청에 대해서 부가 기능을 수행합니다.</li>\n</ul>\n<h5 id=\"프록시-작성의-문제점\" style=\"position:relative;\"><a href=\"#%ED%94%84%EB%A1%9D%EC%8B%9C-%EC%9E%91%EC%84%B1%EC%9D%98-%EB%AC%B8%EC%A0%9C%EC%A0%90\" aria-label=\"프록시 작성의 문제점 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>프록시 작성의 문제점</h5>\n<ul>\n<li>부가기능이 필요 없는 메소드도 구현해서 타깃으로 위임하는 코드를 일일이 만들어줘야해서 <code class=\"language-text\">번거롭다</code>.</li>\n<li>부가기능 코드가 <code class=\"language-text\">중복</code>될 가능성이 많다.</li>\n</ul>\n<h4 id=\"4-다이내믹-프록시\" style=\"position:relative;\"><a href=\"#4-%EB%8B%A4%EC%9D%B4%EB%82%B4%EB%AF%B9-%ED%94%84%EB%A1%9D%EC%8B%9C\" aria-label=\"4 다이내믹 프록시 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4) 다이내믹 프록시</h4>\n<p>자바에는 <code class=\"language-text\">java.lang.reflect</code> 패키지 안에 프록시를 손쉽게 만들수 있도록 지원해주는 클래스들이 있습니다.<br>\n목 프레임워크로 모든 Mock 객체를 생성하지 않은 것처럼, 프록시 클래스를 매번 정의하지 않고도 프록시처럼 동작하는 오브젝트를 다이내믹하게 생성할 수 있습니다.</p>\n<h5 id=\"다이내믹-프록시-적용\" style=\"position:relative;\"><a href=\"#%EB%8B%A4%EC%9D%B4%EB%82%B4%EB%AF%B9-%ED%94%84%EB%A1%9D%EC%8B%9C-%EC%A0%81%EC%9A%A9\" aria-label=\"다이내믹 프록시 적용 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>다이내믹 프록시 적용</h5>\n<p>다이내믹 프록시는 리플렉션 기능을 이용해서 프록시를 만들어줍니다.</p>\n<blockquote>\n<p>리플렉션은 자바의 코드 자체를 추상화해서 접근하도록 만든 것<br>\n참고 : <a href=\"https://medium.com/msolo021015/%EC%9E%90%EB%B0%94-reflection%EC%9D%B4%EB%9E%80-ee71caf7eec5\">자바의 리플렉션이란?</a></p>\n</blockquote>\n<p>프록시로서 필요한 부가기능 제공 코드는 <code class=\"language-text\">InvocationHandler를 구현한 클래스</code>에 직접 작성해야 합니다.<br>\n<code class=\"language-text\">InvocationHandler</code> 인터페이스는 아래 메소드 하나만 가진 간단한 인터페이스입니다.</p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">invoke</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span> proxy<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Method</span> method<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Throwable</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><strong>InvocationHandler의 동작</strong>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA00lEQVQY0z2QBwqEQAxFvf8RLaNiGRvqrA1r1peFDQScJP/lR89aK3EcS5IkEoahtG0r933L8zyy77sYYySKIu0FQSDDMGiPHMdRyrLUOvq6rsUrikJFeZ5roaoqBRLHcbxvK33fa7IMCLFtm6BFx7Ku66RpG/EA4HJZFk2GtNk0+u3cqOJ5nnURjoCgwxVvesQ0TT+HFDnFOacQ0trqFWbqEOcsBQwsyzJJ01RPZRbQeZ4K9miY2KhtwIiv6/qfjNt1XXWYcz/vUoIZ4Pxf3/f/rr/B0neRUH74YQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AOP 6\"\n        title=\"AOP 6\"\n        src=\"/static/b53eaeba6b0999cd826d08f6cac257a2/1d69c/AOP-6.png\"\n        srcset=\"/static/b53eaeba6b0999cd826d08f6cac257a2/4dcb9/AOP-6.png 188w,\n/static/b53eaeba6b0999cd826d08f6cac257a2/5ff7e/AOP-6.png 375w,\n/static/b53eaeba6b0999cd826d08f6cac257a2/1d69c/AOP-6.png 750w,\n/static/b53eaeba6b0999cd826d08f6cac257a2/709cb/AOP-6.png 1034w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>동작 과정을 요약하면 다음과 같습니다.</p>\n<ol>\n<li>Hello 인터페이스를 파라미터로 넘겨주면서 프록시 팩토리에게 다이내믹 프록시를 만들어달라고 요청하면 Hello 인터페이스의 모든 메소드를 구현한 프록시 오브젝트를 생성해줍니다.</li>\n<li>InvocationHandler 인터페이스를 구현한 오브젝트를 제공해주면 다이내믹 프록시가 받는 모든 요청을 InvocationHandler의 invoke() 메소드로 보내줍니다.</li>\n<li>결과적으로, Hello 인터페이스의 메소드가 아무리 많더라도 invoke() 메소드 하나로 처리할 수 있습니다.</li>\n</ol>\n<p>그러면, 이제 위에서 만들었던 트랜잭션 기능을 <code class=\"language-text\">다이내믹 프록시</code>를 적용해 만들어봅시다.</p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TransactionHandler</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">InvocationHandler</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Autowired</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">PlatformTransactionManager</span> transactionManager<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Object</span> target<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> pattern<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setTarget</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span> target<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>target <span class=\"token operator\">=</span> target<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setPattern</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> pattern<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>pattern <span class=\"token operator\">=</span> pattern<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">invoke</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span> proxy<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Method</span> method<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Throwable</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// 트랜잭션 적용 대상 메소드 선별하여 트랜잭션 경계설정 기능 부여해준다.</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>method<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">startsWith</span><span class=\"token punctuation\">(</span>pattern<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token function\">invokeInTransaction</span><span class=\"token punctuation\">(</span>method<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 트랜잭션 적용 O</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> method<span class=\"token punctuation\">.</span><span class=\"token function\">invoke</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 트랜잭션 적용 X</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">invokeInTransaction</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Method</span> method<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Throwable</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">TransactionStatus</span> status <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>transactionManager\n            <span class=\"token punctuation\">.</span><span class=\"token function\">getTransaction</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">DefaultTransactionDefinition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// 트랜잭션을 시작하고 타깃 오브젝트의 메소드를 호출한다.</span>\n            <span class=\"token class-name\">Object</span> ret <span class=\"token operator\">=</span> method<span class=\"token punctuation\">.</span><span class=\"token function\">invoke</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>transactionManager<span class=\"token punctuation\">.</span><span class=\"token function\">commit</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> ret<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">InvocationTargetException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>transactionManager<span class=\"token punctuation\">.</span><span class=\"token function\">rollback</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">throw</span> e<span class=\"token punctuation\">.</span><span class=\"token function\">getTargetException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>테스트</strong></p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Test</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">upgradeAllOrNothing</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n    <span class=\"token comment\">// 핸들러가 필요한 정보와 오브젝트를 DI</span>\n    <span class=\"token class-name\">TransactionHandler</span> txHandler <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TransactionHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    txHandler<span class=\"token punctuation\">.</span><span class=\"token function\">setTransactionManager</span><span class=\"token punctuation\">(</span>transactionManager<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    txHandler<span class=\"token punctuation\">.</span><span class=\"token function\">setTarget</span><span class=\"token punctuation\">(</span>testUserService<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    txHandler<span class=\"token punctuation\">.</span><span class=\"token function\">setPattern</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"upgradeLevels\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// UserService 인터페이스 타입의 다이내믹 프록시 생성</span>\n    <span class=\"token class-name\">UserService</span> txUserService <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">UserService</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Proxy</span><span class=\"token punctuation\">.</span><span class=\"token function\">newProxyInstance</span><span class=\"token punctuation\">(</span>\n        <span class=\"token function\">getClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getClassLoader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Class</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span><span class=\"token class-name\">UserService</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> txHandler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>이렇게 생성된 다이내믹 프록시는 일반적인 방법으로는 스프링의 빈으로 등록할 수 없습니다.<br>\n그래서 스프링은 디폴트 생성자, Setter 이외에도 빈으로 만들 수 있는 방법을 제공하는데, 대표적으로 팩토리 빈을 이용한 빈 생성 방법입니다.<br>\n팩토리 빈을 만드는 방법에는 여러 가지가 있는데, 가장 간단한 방법은 스프링의 FactoryBean이라는 인터페이스를 구현하는 방법이 있습니다.</p>\n<h2 id=\"4-스프링의-프록시-팩토리-빈\" style=\"position:relative;\"><a href=\"#4-%EC%8A%A4%ED%94%84%EB%A7%81%EC%9D%98-%ED%94%84%EB%A1%9D%EC%8B%9C-%ED%8C%A9%ED%86%A0%EB%A6%AC-%EB%B9%88\" aria-label=\"4 스프링의 프록시 팩토리 빈 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. 스프링의 프록시 팩토리 빈</h2>\n<h4 id=\"1-proxyfactorybean\" style=\"position:relative;\"><a href=\"#1-proxyfactorybean\" aria-label=\"1 proxyfactorybean permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1) ProxyFactoryBean</h4>\n<p>자바에는 JDK에서 제공하는 다이내믹 프록시 외에도 편리하게 프록시를 만들 수 있도록 지원해주는 다양한 기술이 존재합니다.</p>\n<p>스프링이 트랜잭션 기술과 메일 발송 기술에 적용했던 서비스 추상화를 프록시 기술에 동일하게 적용해 프록시 오브젝트를 생성해주는 기술을 <code class=\"language-text\">추상화한 팩토리 빈</code>을 제공합니다.</p>\n<p>ProxyFactoryBean이 생성하는 프록시에서 사용할 부가기능은 Methodlnterceptor 인터페이스를 구현해서 만듭니다.</p>\n<h5 id=\"methodlnterceptor-와-invocationhandler의-차이점\" style=\"position:relative;\"><a href=\"#methodlnterceptor-%EC%99%80-invocationhandler%EC%9D%98-%EC%B0%A8%EC%9D%B4%EC%A0%90\" aria-label=\"methodlnterceptor 와 invocationhandler의 차이점 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Methodlnterceptor 와 InvocationHandler의 차이점</h5>\n<p><strong>InvocationHandler</strong></p>\n<ul>\n<li>InvocationHandler의 invoke() 메소드는 타깃 오브젝트에 대한 정보를 제공하지 않습니다.<br>\n따라서 타깃은 InvocationHandler를 구현한 클래스가 직접 알고 있어야 합니다.</li>\n</ul>\n<p><strong>Methodlnterceptor</strong></p>\n<ul>\n<li>Methodlnterceptor의 invoke() 메소드는 ProxyFactoryBean으로부터 <code class=\"language-text\">타깃 오브젝트에 대한 정보</code>까지도 함께 제공받습니다.</li>\n</ul>\n<h5 id=\"proxyfactorybean-예제\" style=\"position:relative;\"><a href=\"#proxyfactorybean-%EC%98%88%EC%A0%9C\" aria-label=\"proxyfactorybean 예제 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ProxyFactoryBean 예제</h5>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token comment\">// ...</span>\n<span class=\"token annotation punctuation\">@Test</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">proxyFactoryBean</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">ProxyFactoryBean</span> pfBean <span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ProxyFactoryBean</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    pfBean<span class=\"token punctuation\">.</span><span class=\"token function\">setTarget</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">HelloTarget</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 타깃 설정</span>\n    pfBean<span class=\"token punctuation\">.</span><span class=\"token function\">addAdvice</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">UpperCaseAdvice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 부가 기능 어드바이스 설정</span>\n\n    <span class=\"token class-name\">Hello</span> proxiedHello <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Hello</span><span class=\"token punctuation\">)</span> pfBean<span class=\"token punctuation\">.</span><span class=\"token function\">getObject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 생성된 프록시를 가져온다.</span>\n    <span class=\"token function\">assertThat</span><span class=\"token punctuation\">(</span>proxiedHello<span class=\"token punctuation\">.</span><span class=\"token function\">sayHi</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"woowon\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">is</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"HI WOOWON\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">UppercaseAdvice</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">MethodInterceptor</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">invoke</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MethodInvocation</span> invocation<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Throwable</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// MethodInvocation은 메소드 정보와 타깃 오브젝트를 모두 가지고 있다.</span>\n        <span class=\"token keyword\">return</span> invocation<span class=\"token punctuation\">.</span><span class=\"token function\">proceed</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toUpperCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// ...</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"2-어드바이스--타깃이-필요-없는-순수한-부가기능\" style=\"position:relative;\"><a href=\"#2-%EC%96%B4%EB%93%9C%EB%B0%94%EC%9D%B4%EC%8A%A4--%ED%83%80%EA%B9%83%EC%9D%B4-%ED%95%84%EC%9A%94-%EC%97%86%EB%8A%94-%EC%88%9C%EC%88%98%ED%95%9C-%EB%B6%80%EA%B0%80%EA%B8%B0%EB%8A%A5\" aria-label=\"2 어드바이스  타깃이 필요 없는 순수한 부가기능 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2) 어드바이스 : 타깃이 필요 없는 순수한 부가기능</h4>\n<p>스프링에서는 타깃 오브젝트에 적용하는 부가기능을 담은 오브젝트를 <code class=\"language-text\">어드바이스(advice)</code>라고 부릅니다.</p>\n<p>Methodlnterceptor에는 메소드 정보와 함께 타깃 오브젝트가 담긴 Methodlnvocation 오브젝트가 전달됩니다.</p>\n<blockquote>\n<p>Methodlnvocation은 일종의 콜백 오브젝트로, proceed() 메소드를 실행하면 타깃 오브젝트의 메소드를 내부적으로 실행해주는 기능</p>\n</blockquote>\n<p>ProxyFactoryBean은 작은 단위의 <code class=\"language-text\">템플릿/콜백 구조</code>를 응용해서 적용했기 때문에 템플릿 역할을 하는 Methodlnvocation을 <code class=\"language-text\">싱글톤</code>으로 두고 <code class=\"language-text\">공유</code>할 수 있습니다.</p>\n<p>addAdvice() 메소드를 통해 ProxyFactoryBean에는 여러 개의 Methodlnterceptor를 추가할 수 있습니다.</p>\n<blockquote>\n<p>ProxyFactoryBean 하나만으로 여러 개의 부가 기능을 제공해주는 프록시를 만들 수 있다는 의미</p>\n</blockquote>\n<h4 id=\"3-포인트컷--부가기능-적용-대상-메소드-선정-방법\" style=\"position:relative;\"><a href=\"#3-%ED%8F%AC%EC%9D%B8%ED%8A%B8%EC%BB%B7--%EB%B6%80%EA%B0%80%EA%B8%B0%EB%8A%A5-%EC%A0%81%EC%9A%A9-%EB%8C%80%EC%83%81-%EB%A9%94%EC%86%8C%EB%93%9C-%EC%84%A0%EC%A0%95-%EB%B0%A9%EB%B2%95\" aria-label=\"3 포인트컷  부가기능 적용 대상 메소드 선정 방법 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3) 포인트컷 : 부가기능 적용 대상 메소드 선정 방법</h4>\n<p>스프링에서는 메소드 선정 알고리즘을 담은 오브젝트를 <code class=\"language-text\">포인트컷(pointcut)</code>이라고 부릅니다.</p>\n<p><strong>기존의 JDK 다이내믹 프록시 방식</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAArklEQVQY06WPzQ6DIBCEff9nM540losejERREPw/SKbONm16bjeZTHYZPpak73vUdY2macS11riuCzHGn5TM84xt29C2LcZxBPt/SoDcMs9zVFUF5xy6rpMZ3RhzP2RhrZUZneJPlmURDcMgS63r+gJ67/F2hqdpkp5wQqg0TaGU+mQIZO44jrt3OM8TIQQkPNz3Xeh8hZDv4pZKPVCWJbIsQ1EUkmMRxruEcUZ/ApVAftyhzyJTAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AOP 7\"\n        title=\"AOP 7\"\n        src=\"/static/aaf27703d67b778e992d168b0aa4d297/1d69c/AOP-7.png\"\n        srcset=\"/static/aaf27703d67b778e992d168b0aa4d297/4dcb9/AOP-7.png 188w,\n/static/aaf27703d67b778e992d168b0aa4d297/5ff7e/AOP-7.png 375w,\n/static/aaf27703d67b778e992d168b0aa4d297/1d69c/AOP-7.png 750w,\n/static/aaf27703d67b778e992d168b0aa4d297/dd104/AOP-7.png 1064w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p><strong>기존 방식의 문제점</strong></p>\n<ul>\n<li>부가 기능을 가진 InvocationHandler가 타깃과 메소드 선정 알고리즘에 의존하고 있다는 점입니다.</li>\n</ul>\n<hr>\n<p>만약 타깃이 다르고 메소드 선정 방식이 다른 경우, InvocationHandler 오브젝트를 여러 프록시가 공유할 수 없습니다.</p>\n<p>이러한 <code class=\"language-text\">문제점을 해결하기 위해</code> 스프링의 ProxyFactoryBean 방식은 두 가지 확장 기능인 <code class=\"language-text\">부가기능</code>과 <code class=\"language-text\">메소드 선정 알고리즘</code>을 활용하는 <code class=\"language-text\">독립적인 구조</code>를 제공한다.</p>\n<p><strong>ProxyFactoryBean의 동작 방식</strong>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.659574468085108%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA+ElEQVQY011R2YqEQAzs//8wXwQfRBR1vcb7PnBWQbR2KqAw21DEdFcqlai6rkPf9+i6HsMw4jgOwXmeWNcV+74/2LbtKyfnuq4nEirLcoRhCN//QVXVIlLXNZqmgeM4iKJI7uI4hqZpki/L8uGW2H438HwJTtME13Xheb4QmRPzPIvo65V8mvmwLAumacIwDARBgDRNxeXt8IZiUVVV4o7fJNNxURQiouu6xFvQ8zwBm3A1/4+6LfNwnxRNkkSEWURx3mdZBtu2JdIARdu2lakYWTcMAxT3s65veSCZu6IQC/jG0Ukcx/FZCX8iJ2DjsixlfDbO8xx/ga7B4l1jV8UAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AOP 8\"\n        title=\"AOP 8\"\n        src=\"/static/63379b1a87a5c574d66bd727bbf7b57e/1d69c/AOP-8.png\"\n        srcset=\"/static/63379b1a87a5c574d66bd727bbf7b57e/4dcb9/AOP-8.png 188w,\n/static/63379b1a87a5c574d66bd727bbf7b57e/5ff7e/AOP-8.png 375w,\n/static/63379b1a87a5c574d66bd727bbf7b57e/1d69c/AOP-8.png 750w,\n/static/63379b1a87a5c574d66bd727bbf7b57e/bb2fd/AOP-8.png 1058w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Test</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">proxyFactoryBean</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">ProxyFactoryBean</span> pfBean <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ProxyFactoryBean</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    pfBean<span class=\"token punctuation\">.</span><span class=\"token function\">setTarget</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">HelloTarget</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 메소드 이름을 비교해서 대상을 선정하는 포인트 컷 설정</span>\n    <span class=\"token class-name\">NameMatchMethodPointcut</span> pointcut <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">NameMatchMethodPointcut</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    pointcut<span class=\"token punctuation\">.</span><span class=\"token function\">setMappedName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sayH*\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 이름 비교 조건 설정</span>\n\n    <span class=\"token comment\">// 포인트컷과 어드바이스를 Advisor로 묶어서 추가</span>\n    pfBean<span class=\"token punctuation\">.</span><span class=\"token function\">addAdvisor</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">DefaultPointcutAdvisor</span><span class=\"token punctuation\">(</span>pointcut<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UpperCaseAdvice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">Hello</span> proxiedHello <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Hello</span><span class=\"token punctuation\">)</span> pfBean<span class=\"token punctuation\">.</span><span class=\"token function\">getObject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// 부가 기능 적용</span>\n    <span class=\"token function\">assertThat</span><span class=\"token punctuation\">(</span>proxiedHello<span class=\"token punctuation\">.</span><span class=\"token function\">sayHi</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"woowon\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">is</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"HI WOOWON\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 포인트컷 선정조건에 맞지 않아서 부가 기능이 적용 안됨</span>\n    <span class=\"token function\">assertThat</span><span class=\"token punctuation\">(</span>proxiedHello<span class=\"token punctuation\">.</span><span class=\"token function\">sayThankYou</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"woowon\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">is</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Thank You woowon\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>포인트 컷과 어드바이스를 묶은 오브젝트를 <code class=\"language-text\">어드바이저(advisor)</code>라고 합니다.<br>\n두 가지를 묶어서 등록하는 이유는 따로 등록하면 어떤 어드바이스에 대해 포인트컷을 적용할지 애매해지기 때문에 함께 묶어서 등록합니다.</p>\n<h5 id=\"어드바이스와-포인트컷의-재사용\" style=\"position:relative;\"><a href=\"#%EC%96%B4%EB%93%9C%EB%B0%94%EC%9D%B4%EC%8A%A4%EC%99%80-%ED%8F%AC%EC%9D%B8%ED%8A%B8%EC%BB%B7%EC%9D%98-%EC%9E%AC%EC%82%AC%EC%9A%A9\" aria-label=\"어드바이스와 포인트컷의 재사용 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>어드바이스와 포인트컷의 재사용</h5>\n<p>ProxyFactoryBean은 스프링의 DI와 템플릿/콜백 패턴, 서비스 추상화 등의 기법이 모두 적용되어서 <code class=\"language-text\">독립적</code>이며 여러 프록시가 <code class=\"language-text\">공유</code>할 수 있는 <code class=\"language-text\">어드바이스</code>와 <code class=\"language-text\">포인트컷</code>으로 확장 기능을 분리할 수 있었다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.148936170212764%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABS0lEQVQoz1WSCY+CQAyF/f8/z42JCwEV5XA4BC9uu3ydndWdpCnTdl5fX1nN8yzY6/WS5/MpxuRSFIVcr1d5PB4aw/h29/v9vvj2179z4KxkOYBxLpeL7Pd78T1fuq7TAh5UVaXxw+Egu91O4tNJkiTRexRFEsex5Hku4zjKqut66XtrTdPo4zAIJU1T/XYMeISdFrDz+ayTZFmmdcYYJaOAnudJGIbi+76s11/aiQIKy7JUQBrBiBigAGEW2GidAg4L4KeGt9tNARmFRpvNRmMUH49HZUfOgeOJWdDKMgQIQA6LSNNMgmVkksjA2G3bag6meIwm3DGWQ2wYhjdDtxSnFUm3sLqulbmTgxH5pp6GgNV1YwE/GdIJg5EFKf4eb7ffC/NAt834jIzubgcsaZqm/xriCeLRDjaIz38JKEzmeRJ3uJOnKRKB8QP5vKwQonL6ywAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AOP 9\"\n        title=\"AOP 9\"\n        src=\"/static/0148a6e32b3962ce1a73a2165bfe1aad/1d69c/AOP-9.png\"\n        srcset=\"/static/0148a6e32b3962ce1a73a2165bfe1aad/4dcb9/AOP-9.png 188w,\n/static/0148a6e32b3962ce1a73a2165bfe1aad/5ff7e/AOP-9.png 375w,\n/static/0148a6e32b3962ce1a73a2165bfe1aad/1d69c/AOP-9.png 750w,\n/static/0148a6e32b3962ce1a73a2165bfe1aad/c6ff8/AOP-9.png 1088w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>","tableOfContents":"<ul>\n<li><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#%EA%B0%9C%EC%9A%94\">개요</a></li>\n<li>\n<p><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#1-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%BD%94%EB%93%9C%EC%9D%98-%EB%B6%84%EB%A6%AC\">1. 트랜잭션 코드의 분리</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#1-di%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%ED%81%B4%EB%9E%98%EC%8A%A4%EC%9D%98-%EB%B6%84%EB%A6%AC\">1) DI를 이용한 클래스의 분리</a></li>\n<li><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#2-%EB%B6%84%EB%A6%AC%EB%90%9C-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EA%B8%B0%EB%8A%A5\">2) 분리된 트랜잭션 기능</a></li>\n<li><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#3-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%A0%81%EC%9A%A9%EC%9D%84-%EC%9C%84%ED%95%9C-di-%EC%84%A4%EC%A0%95\">3) 트랜잭션 적용을 위한 DI 설정</a></li>\n<li><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#4-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%B2%98%EB%A6%AC-%EC%BD%94%EB%93%9C-%EB%B6%84%EB%A6%AC%EC%9D%98-%EC%9E%A5%EC%A0%90\">4) 트랜잭션 처리 코드 분리의 장점</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#2-%EA%B3%A0%EB%A6%BD%EB%90%9C-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8\">2. 고립된 단위 테스트</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#1-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EB%8C%80%EC%83%81-%EA%B3%A0%EB%A6%BD%EC%8B%9C%ED%82%A4%EA%B8%B0\">1) 테스트 대상 고립시키기</a></li>\n<li><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#2-%EA%B3%A0%EB%A6%BD-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8C%85%EC%9D%98-%EC%9E%A5%EC%A0%90\">2) 고립 단위 테스팅의 장점</a></li>\n<li><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#3-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%99%80-%ED%86%B5%ED%95%A9-%ED%85%8C%EC%8A%A4%ED%8A%B8\">3) 단위 테스트와 통합 테스트</a></li>\n<li><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#4-%EB%AA%A9-%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC\">4) 목 프레임워크</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#3-%EB%8B%A4%EC%9D%B4%EB%82%B4%EB%AF%B9-%ED%94%84%EB%A1%9D%EC%8B%9C%EC%99%80-%ED%8C%A9%ED%86%A0%EB%A6%AC-%EB%B9%88\">3. 다이내믹 프록시와 팩토리 빈</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#1-%ED%94%84%EB%A1%9D%EC%8B%9C\">1) 프록시</a></li>\n<li><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#2-%EB%8D%B0%EC%BD%94%EB%A0%88%EC%9D%B4%ED%84%B0-%ED%8C%A8%ED%84%B4\">2) 데코레이터 패턴</a></li>\n<li>\n<p><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#3-%ED%94%84%EB%A1%9D%EC%8B%9C-%ED%8C%A8%ED%84%B4\">3) 프록시 패턴</a></p>\n<ul>\n<li><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#%ED%94%84%EB%A1%9D%EC%8B%9C-%EA%B5%AC%EC%84%B1%EA%B3%BC-%EC%97%AD%ED%95%A0\">프록시 구성과 역할</a></li>\n<li><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#%ED%94%84%EB%A1%9D%EC%8B%9C-%EC%9E%91%EC%84%B1%EC%9D%98-%EB%AC%B8%EC%A0%9C%EC%A0%90\">프록시 작성의 문제점</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#4-%EB%8B%A4%EC%9D%B4%EB%82%B4%EB%AF%B9-%ED%94%84%EB%A1%9D%EC%8B%9C\">4) 다이내믹 프록시</a></p>\n<ul>\n<li><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#%EB%8B%A4%EC%9D%B4%EB%82%B4%EB%AF%B9-%ED%94%84%EB%A1%9D%EC%8B%9C-%EC%A0%81%EC%9A%A9\">다이내믹 프록시 적용</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#4-%EC%8A%A4%ED%94%84%EB%A7%81%EC%9D%98-%ED%94%84%EB%A1%9D%EC%8B%9C-%ED%8C%A9%ED%86%A0%EB%A6%AC-%EB%B9%88\">4. 스프링의 프록시 팩토리 빈</a></p>\n<ul>\n<li>\n<ul>\n<li>\n<p><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#1-proxyfactorybean\">1) ProxyFactoryBean</a></p>\n<ul>\n<li><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#methodlnterceptor-%EC%99%80-invocationhandler%EC%9D%98-%EC%B0%A8%EC%9D%B4%EC%A0%90\">Methodlnterceptor 와 InvocationHandler의 차이점</a></li>\n<li><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#proxyfactorybean-%EC%98%88%EC%A0%9C\">ProxyFactoryBean 예제</a></li>\n</ul>\n</li>\n<li><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#2-%EC%96%B4%EB%93%9C%EB%B0%94%EC%9D%B4%EC%8A%A4--%ED%83%80%EA%B9%83%EC%9D%B4-%ED%95%84%EC%9A%94-%EC%97%86%EB%8A%94-%EC%88%9C%EC%88%98%ED%95%9C-%EB%B6%80%EA%B0%80%EA%B8%B0%EB%8A%A5\">2) 어드바이스 : 타깃이 필요 없는 순수한 부가기능</a></li>\n<li>\n<p><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#3-%ED%8F%AC%EC%9D%B8%ED%8A%B8%EC%BB%B7--%EB%B6%80%EA%B0%80%EA%B8%B0%EB%8A%A5-%EC%A0%81%EC%9A%A9-%EB%8C%80%EC%83%81-%EB%A9%94%EC%86%8C%EB%93%9C-%EC%84%A0%EC%A0%95-%EB%B0%A9%EB%B2%95\">3) 포인트컷 : 부가기능 적용 대상 메소드 선정 방법</a></p>\n<ul>\n<li><a href=\"/category/spring/toby-spring/aop/unittest-and-proxy/#%EC%96%B4%EB%93%9C%EB%B0%94%EC%9D%B4%EC%8A%A4%EC%99%80-%ED%8F%AC%EC%9D%B8%ED%8A%B8%EC%BB%B7%EC%9D%98-%EC%9E%AC%EC%82%AC%EC%9A%A9\">어드바이스와 포인트컷의 재사용</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"[토비의 스프링] 6-1. AOP - 단위 테스트와 프록시","description":"AOP, 트랜잭션, 프록시, 다이나믹 프록시","date":"2020.07.11","emoji":"ℹ️","category":"spring"}}},"pageContext":{"slug":"/category/spring/toby-spring/aop/unittest-and-proxy/","relatedPosts":[{"node":{"fields":{"slug":"/category/spring/toby-spring/service-abstraction/mockup-test/"},"frontmatter":{"title":"[토비의 스프링] 5-2. 단일 책임 원칙과 테스트 추상화","date":"2020.07.07","emoji":"⚠️","category":"spring"}}},{"node":{"fields":{"slug":"/category/spring/toby-spring/service-abstraction/transaction/"},"frontmatter":{"title":"[토비의 스프링] 5-1. 서비스 추상화와 트랜잭션","date":"2020.07.01","emoji":"🔮","category":"spring"}}},{"node":{"fields":{"slug":"/category/spring/toby-spring/spring-exception/"},"frontmatter":{"title":"[토비의 스프링] 4. 스프링 예외 처리","date":"2020.06.27","emoji":"🛠","category":"spring"}}},{"node":{"fields":{"slug":"/category/spring/toby-spring/template-callback/"},"frontmatter":{"title":"[토비의 스프링] 3. 전략 패턴과 템플릿/콜백에 대해서","date":"2020.06.23","emoji":"📃","category":"spring"}}}]}}}