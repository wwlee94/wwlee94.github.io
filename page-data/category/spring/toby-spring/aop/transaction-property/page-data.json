{"componentChunkName":"component---src-templates-post-tsx","path":"/category/spring/toby-spring/aop/transaction-property/","result":{"data":{"site":{"siteMetadata":{"title":"Blausee 기술 블로그","author":"wwlee94","siteUrl":"https://wwlee94.github.io"}},"markdownRemark":{"id":"06fddfbf-7de5-57ae-96d4-dbdf113ff29e","excerpt":"개요  AOP…","html":"<h2 id=\"개요\" style=\"position:relative;\"><a href=\"#%EA%B0%9C%EC%9A%94\" aria-label=\"개요 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>개요</h2>\n<p><code class=\"language-text\">토비의 스프링</code> AOP의 마지막 챕터를 정리한 포스팅입니다.</p>\n<h2 id=\"트랜잭션-정의\" style=\"position:relative;\"><a href=\"#%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%A0%95%EC%9D%98\" aria-label=\"트랜잭션 정의 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>트랜잭션 정의</h2>\n<p><code class=\"language-text\">트랜잭션</code>이라고 모두 같은 방식으로 동작하는 것은 아닙니다.<br>\n물론 트랜잭션의 기본 개념인 ‘더 이상 쪼갤 수 없는 최소 단위의 작업’이라는 개념은 항상 유효합니다.<br>\n트랜잭션 경계 안에서 진행된 작업은 <code class=\"language-text\">commit()</code>을 통해 모두 성공하든지 아니면 <code class=\"language-text\">rollback()</code>을 통해 모두 취소 되어야합니다.<br>\n그런데 이 밖에도 트랜잭션의 동작방식을 제어할 수 있는 4가지 속성이 있습니다.</p>\n<h4 id=\"트랜잭션-전파\" style=\"position:relative;\"><a href=\"#%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%A0%84%ED%8C%8C\" aria-label=\"트랜잭션 전파 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>트랜잭션 전파</h4>\n<p><code class=\"language-text\">트랜잭션 전파</code>(transaction propagation)이란 트랜잭션의 경계에서 이미 진행 중인 트랜잭션이 있을 때 또는 없을 때 어떻게 동작할 것인가를 결정하는 방식입니다.</p>\n<p>대표적으로 다음과 같은 <code class=\"language-text\">전파 속성</code>을 줄 수 있습니다.</p>\n<h5 id=\"propagation-required\" style=\"position:relative;\"><a href=\"#propagation-required\" aria-label=\"propagation required permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROPAGATION REQUIRED</h5>\n<p>진행 중인 트랜잭션이 없으면 새로 시작하고, 이미 시작된 트랜잭션이 있으면 이에 참여합니다.<br>\n‘DefaultTransactionDefinition’의 트랜잭션 전파 속성이 <code class=\"language-text\">PROPAGATION_REQUIRED</code> 입니다.</p>\n<h5 id=\"propagation-requires-new\" style=\"position:relative;\"><a href=\"#propagation-requires-new\" aria-label=\"propagation requires new permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROPAGATION REQUIRES NEW</h5>\n<p>항상 새로운 트랜잭션을 시작합니다.<br>\n즉, 앞에서 시작된 트랜잭션이 있든 없든 상관없이 새로운 트랜잭션을 만들어서 독자적으로 동작합니다.</p>\n<h5 id=\"propagation-not-supported\" style=\"position:relative;\"><a href=\"#propagation-not-supported\" aria-label=\"propagation not supported permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PROPAGATION NOT SUPPORTED</h5>\n<p>이 속성을 사용하면 트랜잭션없이 동작하도록 만들 수도 있습니다.<br>\n진행 중인 트랜잭션이 있어도 무시합니다.</p>\n<hr>\n<p>이렇게 트랜잭션 매니저를 통해 트랜잭션을 시작하려고 할 때, <code class=\"language-text\">getTransaction()</code>이라는 메소드를 사용하는 이유는 바로 항상 트랜잭션을 새로 시작하는 것이 아니기 때문입니다.<br>\n새로 시작할 수도 있고, 현재 진행 중인 트랜잭션에 참여해서 동작할 수도 있습니다.</p>\n<h4 id=\"격리-수준\" style=\"position:relative;\"><a href=\"#%EA%B2%A9%EB%A6%AC-%EC%88%98%EC%A4%80\" aria-label=\"격리 수준 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>격리 수준</h4>\n<p>모든 DB 트랜잭션은 <code class=\"language-text\">격리수준</code>(isolation level)을 가지고 있어야합니다.</p>\n<p>서버 환경에서는 여러 개의 트랜잭션이 동시에 진행될 수 있기 때문입니다.<br>\n순차적으로 진행되어 독립적이면 좋겠지만 <code class=\"language-text\">성능</code>이 크게 떨어질 수 밖에 없습니다.<br>\n따라서, 적절하게 격리수준을 조정해서 가능한 한 많은 트랜잭션을 <code class=\"language-text\">동시에 진행</code>시키면서도 문제가 발생하지 않게 하는 <code class=\"language-text\">제어가 필요</code>합니다.</p>\n<p>격리수준은 기본적으로 DB에 설정되어 있지만 JDBC 드라이버나 DataSource 등에서 재설정할 수 있고, 필요하다면 트랜잭션 단위로 격리수준을 조정할 수 있습니다.</p>\n<h5 id=\"제한-시간\" style=\"position:relative;\"><a href=\"#%EC%A0%9C%ED%95%9C-%EC%8B%9C%EA%B0%84\" aria-label=\"제한 시간 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>제한 시간</h5>\n<p>트랜잭션을 수해하는 <code class=\"language-text\">제한 시간</code>(timeout)을 설정할 수 있습니다.<br>\n‘DefaultTransactionDefinition’의 기본 설정은 제한시간이 없고 <code class=\"language-text\">제한 시간</code>은 트랜잭션을 직접 시작할 수 있는 <code class=\"language-text\">PROPAGATION_REQUIRED</code>, <code class=\"language-text\">PROPAGATION_REQUIRES_NEW</code>와 함께 사용해야만 의미가 있습니다.</p>\n<h5 id=\"읽기-전용\" style=\"position:relative;\"><a href=\"#%EC%9D%BD%EA%B8%B0-%EC%A0%84%EC%9A%A9\" aria-label=\"읽기 전용 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>읽기 전용</h5>\n<p><code class=\"language-text\">읽기 전용</code>(read-only)으로 설정해두면 트랜잭션 내에서 데이터를 조작하는 시도를 막아줄 수 있고 데이터 액세스 기술에 따라서 <code class=\"language-text\">성능이 향상</code>될 수도 있다.</p>\n<h2 id=\"트랜잭션-인터셉터와-트랜잭션-속성\" style=\"position:relative;\"><a href=\"#%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%9D%B8%ED%84%B0%EC%85%89%ED%84%B0%EC%99%80-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%86%8D%EC%84%B1\" aria-label=\"트랜잭션 인터셉터와 트랜잭션 속성 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>트랜잭션 인터셉터와 트랜잭션 속성</h2>\n<p>메소드 별로 다른 트랜잭션 정의를 적용하려면 어드바이스의 기능을 확장해야합니다.<br>\n메소드 이름 패턴에 따라 다른 트랜잭션 정의가 되도록 구현하는 것과 비슷합니다.</p>\n<p>스프링에서 제공하는 클래스로 편리하게 트랜잭션 경계설정 어드바이스로 사용할 수 있도록 ‘TransactionInterceptor’을 제공합니다.</p>\n<p>‘TransactionInterceptor’은 ‘PlatformTransactionManager’와 ‘Properties’ 타입의 두 가지 프로퍼티를 갖고 있습니다.</p>\n<blockquote>\n<p>Properties는 트랜잭션 속성 3가지 + rollbackOn()이라는 속성을 가집니다.</p>\n</blockquote>\n<p>그리고 스프링이 제공하는 ‘TransactionInterceptor’에는 기본적으로 두 가지 종류의 예외 처리 방식이 있다.</p>\n<ul>\n<li>런타임 예외 : 트랜잭션은 롤백됩니다.</li>\n<li>체크 예외 : 예외상황으로 해석하지 않고 일종의 비즈니스 로직에 따른, 의미가 있는 리턴 방식의 한 가지로 인식해서 트랜잭션을 커밋합니다.</li>\n</ul>\n<p>이러한 동작의 <code class=\"language-text\">이유</code>는 스프링의 기본적인 예외처리 원칙에 따라 비즈니스적인 의미가 있는 예외상황만 체크 예외를 사용하고, 그 외의 모든 복구 불가능한 순수한 예외의 경우는 런타임 예외로 포장돼서 전달하는 방식을 따른다고 가정하기 때문입니다.</p>\n<h4 id=\"포인트컷과-트랜잭션-속성의-적용-전략\" style=\"position:relative;\"><a href=\"#%ED%8F%AC%EC%9D%B8%ED%8A%B8%EC%BB%B7%EA%B3%BC-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%86%8D%EC%84%B1%EC%9D%98-%EC%A0%81%EC%9A%A9-%EC%A0%84%EB%9E%B5\" aria-label=\"포인트컷과 트랜잭션 속성의 적용 전략 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>포인트컷과 트랜잭션 속성의 적용 전략</h4>\n<p><strong>1. 트랜잭션 포인트컷 표현식은 타입 패턴이나 빈 이름을 이용합니다.</strong></p>\n<p><strong>2. 공통된 메소드 이름 규칙을 통해 최소한의 트랜잭션 어드바이스와 속성을 정의합니다.</strong></p>\n<p><strong>3. 프록시 방식 AOP는 같은 타킷 오브젝트 내의 메소드를 호출할 때는 적용되지 않습니다.</strong></p>\n<p>프록시 방식의 AOP에서는 프록시를 통한 부가기능의 적용은 클라이언트로부터 호출이 일어날 때만 가능합니다.<br>\n자기 자신의 메소드를 호출할 때는 프록시를 통한 부가기능의 적용이 일어나지 않습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e880356e2a184732cfa020bc6bb10662/8d919/aop-1.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.531914893617024%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdqQuD//xAAXEAADAQAAAAAAAAAAAAAAAAAAARAR/9oACAEBAAEFAtFP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAGBABAQEBAQAAAAAAAAAAAAAAAQARIUH/2gAIAQEAAT8hVdmQZ7f/2gAMAwEAAgADAAAAEAPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGBABAAMBAAAAAAAAAAAAAAAAAQARITH/2gAIAQEAAT8QFZu52BYKYb2IKtP/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"그림 1\"\n        title=\"그림 1\"\n        src=\"/static/e880356e2a184732cfa020bc6bb10662/acb04/aop-1.jpg\"\n        srcset=\"/static/e880356e2a184732cfa020bc6bb10662/bc01b/aop-1.jpg 188w,\n/static/e880356e2a184732cfa020bc6bb10662/bf173/aop-1.jpg 375w,\n/static/e880356e2a184732cfa020bc6bb10662/acb04/aop-1.jpg 750w,\n/static/e880356e2a184732cfa020bc6bb10662/ec605/aop-1.jpg 1125w,\n/static/e880356e2a184732cfa020bc6bb10662/8d919/aop-1.jpg 1182w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li><code class=\"language-text\">[1], [3]</code>은 클라이언트로부터 메소드가 호출되면 프록시를 통해 타깃에게 전달되므로 트랜잭션 경계설정 기능이 부여됩니다.</li>\n<li><code class=\"language-text\">[2]</code>는 타깃 오브젝트 내로 들어와서 다른 메소드를 호출하는 경우에는 프록시를 거치지 않고 직접 타깃의 메소드가 호출되어 부가기능이 적용되지 않습니다.</li>\n</ul>\n<p>타깃 안에서의 호출에는 프록시가 적용되지 않는 문제를 <code class=\"language-text\">해결할 수 있는 방법</code>은 두 가지가 있습니다.</p>\n<ol>\n<li>스프링 API를 이용해 프록시 오브젝트에 대한 레퍼런스를 가져온 뒤에 같은 오브젝트의 메소드 호출도 <code class=\"language-text\">프록시를 이용하도록 강제</code>하는 방법</li>\n<li><code class=\"language-text\">AspectJ</code>와 같은 타깃의 <code class=\"language-text\">바이트코드를 직접 조작</code>하는 방식의 AOP 기술을 적용</li>\n</ol>\n<h2 id=\"트랜잭션-속성-적용\" style=\"position:relative;\"><a href=\"#%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%86%8D%EC%84%B1-%EC%A0%81%EC%9A%A9\" aria-label=\"트랜잭션 속성 적용 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>트랜잭션 속성 적용</h2>\n<h4 id=\"트랜잭션-경계-설정의-일원화\" style=\"position:relative;\"><a href=\"#%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EA%B2%BD%EA%B3%84-%EC%84%A4%EC%A0%95%EC%9D%98-%EC%9D%BC%EC%9B%90%ED%99%94\" aria-label=\"트랜잭션 경계 설정의 일원화 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>트랜잭션 경계 설정의 일원화</h4>\n<ul>\n<li>트랜잭션 경계설정의 부가기능을 여러 계층에서 중구난방으로 적용하는 것은 좋지 않습니다.</li>\n<li>비즈니스 로직을 담고 있는 서비스 계층 오브젝트의 메소드가 트랜잭션 경계를 부여하기에 가장 적절한 대상입니다.</li>\n<li>테스트와 같은 특별한 이유가 아니고는 다른 계층이나 모듈에서 <code class=\"language-text\">DAO</code>를 직접 접근하는 것은 차단해야합니다.</li>\n<li>Service 계층을 통해서 접근하는 것이 좋습니다.</li>\n</ul>\n<h2 id=\"애노테이션-트랜잭션-속성과-포인트컷\" style=\"position:relative;\"><a href=\"#%EC%95%A0%EB%85%B8%ED%85%8C%EC%9D%B4%EC%85%98-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%86%8D%EC%84%B1%EA%B3%BC-%ED%8F%AC%EC%9D%B8%ED%8A%B8%EC%BB%B7\" aria-label=\"애노테이션 트랜잭션 속성과 포인트컷 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>애노테이션 트랜잭션 속성과 포인트컷</h2>\n<p>포인트컷 표현식과 트랜잭션 속성을 이용해 트랜잭션을 일괄적으로 적용하는 방식은 복잡한 트랜잭션 속성이 요구되지 않는 한 잘 들어맞습니다.<br>\n그런데 가끔은 클래스나 메서드 단위의 세밀하게 튜닝된 트랜잭션 속성을 적용해야 하는 경우에는 매번 포인트컷이나 어드바이스를 추가해야하기 때문에 적합하지 않습니다.</p>\n<p>이런 세밀한 트랜잭션 속성의 제어를 위해 스프링은 ‘직접 타깃에 애노테이션을 지정하는 방법’을 제공합니다.</p>\n<h4 id=\"트랜잭션-애노테이션\" style=\"position:relative;\"><a href=\"#%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%95%A0%EB%85%B8%ED%85%8C%EC%9D%B4%EC%85%98\" aria-label=\"트랜잭션 애노테이션 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>트랜잭션 애노테이션</h4>\n<p><strong>@Transaction</strong></p>\n<p>다음 코드는 <code class=\"language-text\">@Transaction</code>를 정의한 코드입니다.</p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Target</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token class-name\">ElementType</span><span class=\"token punctuation\">.</span>METHOD<span class=\"token punctuation\">,</span> <span class=\"token class-name\">ElementType</span><span class=\"token punctuation\">.</span>TYPE<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 애노테이션을 사용할 대상을 지정</span>\n<span class=\"token annotation punctuation\">@Retention</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">RetentionPolicy</span><span class=\"token punctuation\">.</span>RUNTIME<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 애노테이션 정보가 언제까지 유지되는지</span>\n<span class=\"token annotation punctuation\">@Inherited</span> <span class=\"token comment\">// 상속을 통해서도 애노테이션 정보를 얻을 수 있도록</span>\n<span class=\"token annotation punctuation\">@Documented</span>\n<span class=\"token comment\">// 트랜잭션 속성의 모든 항목을 엘리먼트로 지정 가능, 디폴트 값이 설정되어 있으므로 모두 생략이 가능</span>\n<span class=\"token keyword\">public</span> <span class=\"token annotation punctuation\">@interface</span> <span class=\"token class-name\">Transactional</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token class-name\">String</span> <span class=\"token function\">value</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">default</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token class-name\">Propagation</span> <span class=\"token function\">propagation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">default</span> <span class=\"token class-name\">Propagation</span><span class=\"token punctuation\">.</span>REQUIRED<span class=\"token punctuation\">;</span>\n\t<span class=\"token class-name\">Isolation</span> <span class=\"token function\">isolation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">default</span> <span class=\"token class-name\">Isolation</span><span class=\"token punctuation\">.</span>DEFAULT<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">int</span> <span class=\"token function\">timeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">default</span> <span class=\"token class-name\">TransactionDefinition</span><span class=\"token punctuation\">.</span>TIMEOUT_DEFAULT<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">boolean</span> <span class=\"token function\">readOnly</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">default</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token class-name\">Class</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Throwable</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token function\">rollbackFor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token function\">rollbackForClassName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token class-name\">Class</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token operator\">?</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Throwable</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token function\">noRollbackFor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token function\">noRollbackForClassName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">@Transaction</code>의 타깃은 <code class=\"language-text\">메소드</code>와 <code class=\"language-text\">타입</code>입니다.<br>\n따라서 메소드, 클래스, 인터페이스에 사용할 수 있고 <code class=\"language-text\">@Transaction</code>은 기본적으로 <code class=\"language-text\">트랜잭션 속성을 지정</code>하는 것이지만, 동시에 <code class=\"language-text\">포인트컷의 자동 등록</code>에도 사용됩니다.</p>\n<hr>\n<p>다음 그림은 <code class=\"language-text\">@Transactional</code>을 사용했을 때 어드바이저의 동작 방식입니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0b63478162367e0be2ad687d650bfc15/d53ff/aop-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.340425531914892%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAv0lEQVQY012QWQuDQAyE/f//TLxeBMUD8Va2rgd4oOi0E2gfOhCSZT8mQwx8dJ4nsixDURTo+x7TNElvmgZ1XUtVVSX/Siksy4LneXDfN/5l7PsuMA04E+bsOA4sy4LruvA8D3Ecy1Iaruv6M1DqJYvatsW2bTDGcUQQBAJ+dRyHvPWgJT1F+LouqTzPUZalmDA9Ozn+GYTneUaappKAabXW0gkPw4Cu6xCGIaIoQpIkME0Ttm3D930x5okonuANxRcsUoIEqFoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"그림 2\"\n        title=\"그림 2\"\n        src=\"/static/0b63478162367e0be2ad687d650bfc15/1d69c/aop-2.png\"\n        srcset=\"/static/0b63478162367e0be2ad687d650bfc15/4dcb9/aop-2.png 188w,\n/static/0b63478162367e0be2ad687d650bfc15/5ff7e/aop-2.png 375w,\n/static/0b63478162367e0be2ad687d650bfc15/1d69c/aop-2.png 750w,\n/static/0b63478162367e0be2ad687d650bfc15/d53ff/aop-2.png 1068w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><code class=\"language-text\">@Transactional</code> 방식을 이용하면 포인트컷과 트랜잭션 속성을 <code class=\"language-text\">애노테이션 하나로 지정</code>할 수 있습니다.<br>\n그리고 트랜잭션 속성은 타입 레벨에 일괄적으로 부여할 수도 있지만 메소드 단위로 세분화해서 트랜잭션 속성을 다르게 지정할 수도 있기 때문에 매우 <code class=\"language-text\">세밀한 트랜잭션 속성 제어</code>가 가능해집니다.</p>\n<h4 id=\"대체-정책\" style=\"position:relative;\"><a href=\"#%EB%8C%80%EC%B2%B4-%EC%A0%95%EC%B1%85\" aria-label=\"대체 정책 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>대체 정책</h4>\n<p>스프링은 <code class=\"language-text\">@Transactional</code>을 적용할 때 4단계의 대체(fallback)정책을 이용하게 해줍니다.</p>\n<p>4단계 대체 정책은 다음과 같습니다.</p>\n<ol>\n<li>타깃 메소드에 @Transactional이 있는지 확인</li>\n<li>@Transactional이 부여되어 있다면 이를 속성으로 사용</li>\n<li>없다면, 다음 대체 후보인 타깃 클래스에 부여된 @Transactional를 찾음</li>\n<li>메소드 레벨에는 없지만, 클래스 레벨에 @Transactional이 존재하면 이를 메소드의 트랜잭션으로 사용</li>\n</ol>\n<p><strong>@Transactional 대체 정책의 예</strong></p>\n<p><code class=\"language-text\">[x]</code>는 검색의 <code class=\"language-text\">우선 순위</code>입니다.</p>\n<blockquote>\n<p>낮을 수록 높은 우선순위</p>\n</blockquote>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token comment\">// [4]</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Service</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\">// [3]</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">method1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">// [3]</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">method2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 타깃 클래스 [2]</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Servicelmpl</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Service</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\">// [1]</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">method1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>\n\t<span class=\"token comment\">// [1]</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">method2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">@Transactional</code>도 타깃 클래스보다는 인터페이스에 두는 게 바람직합니다.<br>\n하지만 인터페이스를 사용하는 프록시 방식의 AOP가 아닌 방식으로 트랜잭션을 적용하면 인터페이스에 정의한 <code class=\"language-text\">@Transactional</code>은 무시되기 때문에 안전하게 타깃 클래스에 <code class=\"language-text\">@Transactional</code>을 두는 방법을 권장합니다.</p>\n<p>단, 인터페이스에 <code class=\"language-text\">@Transactional</code>를 두면 구현 클래스가 바뀌더라도 트랜잭션 속성을 유지할 수 있다는 장점이 있습니다.</p>\n<blockquote>\n<p>확신이 있다면 인터페이스에 ! 아니면 타깃 클래스에 선언 !</p>\n</blockquote>\n<h2 id=\"트랜잭션-지원-테스트\" style=\"position:relative;\"><a href=\"#%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%A7%80%EC%9B%90-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"트랜잭션 지원 테스트 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>트랜잭션 지원 테스트</h2>\n<h4 id=\"트랜잭션-동기화와-테스트\" style=\"position:relative;\"><a href=\"#%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EB%8F%99%EA%B8%B0%ED%99%94%EC%99%80-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"트랜잭션 동기화와 테스트 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>트랜잭션 동기화와 테스트</h4>\n<ul>\n<li>\n<p>트랜잭션 추상화 기술의 핵심은 트랜잭션 매니저와 트랜잭션 동기화입니다.</p>\n<ul>\n<li>트랜잭션 매니저 : PlatformTransactionManager 인터페이스를 구현한 트랜잭션 매니저를 통해 구체적인 트랜잭션 기술의 종류에 상관없이 일관된 트랜잭션 제어가 가능</li>\n<li>트랜잭션 동기화 : 트랜잭션 동기화 기술이 있었기에 시작된 트랜잭션 정보를 저장소에 보관해뒀다가 DAO에서 공유 가능</li>\n</ul>\n</li>\n</ul>\n<p>트랜잭션 동기화 기술은 트랜잭션 전파를 위해서도 다음과 같은 중요한 역할을 합니다.</p>\n<ol>\n<li>진행 중인 트랜잭션이 있는지 확인</li>\n<li>트랜잭션 전파 속성에 따라서 이에 참여할 수 있도록 만들어줌</li>\n</ol>\n<p>이 모든 것은 <code class=\"language-text\">트랜잭션 동기화</code> 기술 덕분 !</p>\n<p>이제 한번 간단한 테스트를 추가해봅시다.</p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Test</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">transactionSync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    userService<span class=\"token punctuation\">.</span><span class=\"token function\">deleteAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    userService<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    userService<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>‘transactionSync()’ 테스트 메소드가 실행되는 동안 몇 개의 트랜잭션이 만들어 졌을까?!</strong></p>\n<p>정답은 <code class=\"language-text\">UserService</code>의 모든 메소드에 트랜잭션을 적용했으니 3개가 적용됩니다.</p>\n<hr>\n<p><strong>그렇다면, 이 테스트 메소드에서 만들어지는 세 개의 트랜잭션을 하나로 통합하려면 ?</strong></p>\n<p><code class=\"language-text\">하나의 커넥션을 사용</code>해서 트랜잭션을 유지해야합니다 !</p>\n<p>즉 3개의 동작이 이루어지기 전에 트랜잭션을 <code class=\"language-text\">미리 시작</code>하면 됩니다.</p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Test</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">transactionSync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">DefaultTransactionDefinition</span> definition <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DefaultTransactionDefinition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">TransactionStatus</span> status <span class=\"token operator\">=</span> transactionManager<span class=\"token punctuation\">.</span><span class=\"token function\">getTransaction</span><span class=\"token punctuation\">(</span>definition<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    userService<span class=\"token punctuation\">.</span><span class=\"token function\">deleteAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    userService<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    userService<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    transactionManager<span class=\"token punctuation\">.</span><span class=\"token function\">commit</span><span class=\"token punctuation\">(</span>status<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"롤백-테스트\" style=\"position:relative;\"><a href=\"#%EB%A1%A4%EB%B0%B1-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"롤백 테스트 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>롤백 테스트</h4>\n<p>테스트 코드로 트랜잭션을 제어해서 적용할 수 있는 테스트 기법이 있습니다.<br>\n바로 <code class=\"language-text\">롤백 테스트</code>입니다 !</p>\n<p><code class=\"language-text\">롤백 테스트</code>는 테스트 내의 모든 DB 작업을 하나의 트랜잭션 안에서 동작하게하고 테스트가 끝나면 무조건 롤백해버리는 테스트를 말합니다.</p>\n<p>다음과 같은 코드가 전형적인 롤백 테스트입니다.</p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Test</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">transactionSync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">DefaultTransactionDefinition</span> txDefinition <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DefaultTransactionDefinition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">TransactionStatus</span> txStatus <span class=\"token operator\">=</span> transactionManager<span class=\"token punctuation\">.</span><span class=\"token function\">getTransaction</span><span class=\"token punctuation\">(</span>txDefinition<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n        userService<span class=\"token punctuation\">.</span><span class=\"token function\">deleteAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        userService<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        userService<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\n        transactionManager<span class=\"token punctuation\">.</span><span class=\"token function\">rollback</span><span class=\"token punctuation\">(</span>txStatus<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><code class=\"language-text\">롤백 테스트</code>는 DB 작업이 포함된 테스트가 수행되어도 DB에 영향을 주지 않기 때문에 <code class=\"language-text\">장점</code>이 많습니다.<br>\n복잡한 데이터를 바탕으로 동작하는 기능을 테스트하려면 테스트가 실행될 때의 DB 데이터와 상태가 매우 중요합니다.<br>\n문제는 테스트를 실행할 때마다 데이터가 변한다는 것인데 이런 문제를 <code class=\"language-text\">롤백 테스트</code>로 해결할 수 있습니다.</p>\n<p>롤백 테스트는 심지어 여러 개발자가 하나의 공용 테스트용 DB를 사용할 수 있게 도와줍니다.<br>\n적절한 격리 수준만 보장해주면 동시에 여러 개의 테스트가 진행되어도 상관 없습니다 !</p>\n<p>또한 DB에 따라서 성공적인 작업이라도 트랜잭션을 롤백하면 커밋할 때보다 성능이 향상되기도 합니다</p>\n<blockquote>\n<p>MySQL의 속도는 롤백 > 커밋</p>\n</blockquote>\n<p>하지만, DB의 트랜잭션 처리 방법에 따라 롤백과 커밋의 속도 차이는 있습니다.</p>\n<h2 id=\"테스트를-위한-트랜잭션-애노테이션\" style=\"position:relative;\"><a href=\"#%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EC%9C%84%ED%95%9C-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%95%A0%EB%85%B8%ED%85%8C%EC%9D%B4%EC%85%98\" aria-label=\"테스트를 위한 트랜잭션 애노테이션 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>테스트를 위한 트랜잭션 애노테이션</h2>\n<p>스프링의 컨텍스트 테스트 프레임워크는 애노테이션을 이용해 테스트를 편리하게 만들 수 있는 여러 가지 기능을 추가하게 해줍니다.</p>\n<h4 id=\"transaction\" style=\"position:relative;\"><a href=\"#transaction\" aria-label=\"transaction permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@Transaction</h4>\n<p>테스트에도 <code class=\"language-text\">@Transaction</code>을 적용할 수 있습니다.<br>\n테스트 클래스, 메소드에 <code class=\"language-text\">@Transaction</code>을 적용하면 마치 타깃 클래스나 인터페이스에 적용한 것처럼 테스트 메소드에 트랜잭션 경계가 <code class=\"language-text\">자동으로 설정</code>됩니다.</p>\n<p>물론 테스트에서 사용하는 <code class=\"language-text\">@Transaction</code>은 AOP를 위한 것은 아닙니다.\n하지만 기본적인 동작방식과 속성은 <code class=\"language-text\">UserService</code> 등에 적용한 <code class=\"language-text\">@Transaction</code>과 동일하므로 이해하기 쉽고 사용하기 편리합니다.</p>\n<p><strong>하나의 트랜잭션으로 동작하는 테스트 @Transaction</strong></p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Test</span>\n<span class=\"token annotation punctuation\">@Transaction</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">transactionSync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    userService<span class=\"token punctuation\">.</span><span class=\"token function\">deleteAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    userService<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    userService<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"rollback\" style=\"position:relative;\"><a href=\"#rollback\" aria-label=\"rollback permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@Rollback</h4>\n<p>테스트용 트랜잭션은 테스트가 끝나면 자동으로 롤백됩니다.<br>\n<code class=\"language-text\">@Transaction</code>을 지정해주기만 하면 자동으로 <code class=\"language-text\">롤백 테스트</code>로 설정됩니다 !</p>\n<p>하지만, 강제 롤백을 원하지 않는 경우엔 어떻게 하면 좋을까?</p>\n<p>이때는, <code class=\"language-text\">@Rollback</code>이라는 애노테이션을 사용하면 됩니다.<br>\n<code class=\"language-text\">@Rollback</code>은 롤백 여부를 지정하는 값을 가지고 있습니다.</p>\n<blockquote>\n<p>@Rollback의 기본 값은 true</p>\n</blockquote>\n<p>따라서, 롤백을 원치 않는다면 <code class=\"language-text\">@Rollback(false)</code>라고 해줘야합니다.</p>\n<p><strong>만약, 모든 테스트 클래스의 모든 메소드에 트랜잭션을 적용하면서 롤백되지 않고 커밋되게 하려면 어떻게 해야할 까?</strong></p>\n<p>이런 경우엔 클래스 레벨에 적용시킬 수 있도록 <code class=\"language-text\">@TransactionConfiguration(defaultRollback=false)</code>를 적용하면 됩니다.</p>\n<h4 id=\"propagationnever\" style=\"position:relative;\"><a href=\"#propagationnever\" aria-label=\"propagationnever permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Propagation.NEVER</h4>\n<p>트랜잭션이 일부 메서드에서 필요없는 경우가 있을 수 있습니다.<br>\n그럴 경우는 다음과 같이 사용하면 됩니다.</p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Transactional</span><span class=\"token punctuation\">(</span>propagation <span class=\"token operator\">=</span> <span class=\"token class-name\">Propagation</span><span class=\"token punctuation\">.</span>NEVER<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>위의 애노테이션을 테스트 메소드에 지정하면 트랜잭션이 시작되지 않고 동작합니다 !</p>\n<h4 id=\"효과적인-db-테스트\" style=\"position:relative;\"><a href=\"#%ED%9A%A8%EA%B3%BC%EC%A0%81%EC%9D%B8-db-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"효과적인 db 테스트 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>효과적인 DB 테스트</h4>\n<ul>\n<li>단위 테스트와 DB 같은 외부 리소스가 참여하는 통합 테스트는 아예 클래스를 구분.</li>\n<li>\n<p>DB가 사용되는 통합 테스트는 가능한 한 롤백 테스트로 만드는 게 좋음.</p>\n<ul>\n<li><code class=\"language-text\">@Transaction</code>을 사용해서 롤백 테스트로 !</li>\n<li>테스트가 기본적으로 롤백 테스트로 되어 있다면 테스트 사이에 서로 영향을 주지 않으므로 독립적이고 자동화된 테스트로 만들기가 매우 편함</li>\n</ul>\n</li>\n<li>테스트는 어떤 경우에도 서로 의존하면 안됨</li>\n</ul>\n<h2 id=\"마무리\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EB%AC%B4%EB%A6%AC\" aria-label=\"마무리 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>마무리</h2>\n<p>지금까지 이번 <code class=\"language-text\">토비의 스프링</code>에서 가장 긴 챕터인 <code class=\"language-text\">AOP</code>에 대해서 알아보았습니다.</p>\n<p>다음 포스팅은 <code class=\"language-text\">스프링의 핵심 기술의 응용</code>에 대해서 알아보겠습니다.</p>\n<p>감사합니다 🙇🏻‍♂️</p>","tableOfContents":"<ul>\n<li><a href=\"/category/spring/toby-spring/aop/transaction-property/#%EA%B0%9C%EC%9A%94\">개요</a></li>\n<li>\n<p><a href=\"/category/spring/toby-spring/aop/transaction-property/#%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%A0%95%EC%9D%98\">트랜잭션 정의</a></p>\n<ul>\n<li>\n<ul>\n<li>\n<p><a href=\"/category/spring/toby-spring/aop/transaction-property/#%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%A0%84%ED%8C%8C\">트랜잭션 전파</a></p>\n<ul>\n<li><a href=\"/category/spring/toby-spring/aop/transaction-property/#propagation-required\">PROPAGATION REQUIRED</a></li>\n<li><a href=\"/category/spring/toby-spring/aop/transaction-property/#propagation-requires-new\">PROPAGATION REQUIRES NEW</a></li>\n<li><a href=\"/category/spring/toby-spring/aop/transaction-property/#propagation-not-supported\">PROPAGATION NOT SUPPORTED</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/spring/toby-spring/aop/transaction-property/#%EA%B2%A9%EB%A6%AC-%EC%88%98%EC%A4%80\">격리 수준</a></p>\n<ul>\n<li><a href=\"/category/spring/toby-spring/aop/transaction-property/#%EC%A0%9C%ED%95%9C-%EC%8B%9C%EA%B0%84\">제한 시간</a></li>\n<li><a href=\"/category/spring/toby-spring/aop/transaction-property/#%EC%9D%BD%EA%B8%B0-%EC%A0%84%EC%9A%A9\">읽기 전용</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/spring/toby-spring/aop/transaction-property/#%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%9D%B8%ED%84%B0%EC%85%89%ED%84%B0%EC%99%80-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%86%8D%EC%84%B1\">트랜잭션 인터셉터와 트랜잭션 속성</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/spring/toby-spring/aop/transaction-property/#%ED%8F%AC%EC%9D%B8%ED%8A%B8%EC%BB%B7%EA%B3%BC-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%86%8D%EC%84%B1%EC%9D%98-%EC%A0%81%EC%9A%A9-%EC%A0%84%EB%9E%B5\">포인트컷과 트랜잭션 속성의 적용 전략</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/spring/toby-spring/aop/transaction-property/#%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%86%8D%EC%84%B1-%EC%A0%81%EC%9A%A9\">트랜잭션 속성 적용</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/spring/toby-spring/aop/transaction-property/#%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EA%B2%BD%EA%B3%84-%EC%84%A4%EC%A0%95%EC%9D%98-%EC%9D%BC%EC%9B%90%ED%99%94\">트랜잭션 경계 설정의 일원화</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/spring/toby-spring/aop/transaction-property/#%EC%95%A0%EB%85%B8%ED%85%8C%EC%9D%B4%EC%85%98-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%86%8D%EC%84%B1%EA%B3%BC-%ED%8F%AC%EC%9D%B8%ED%8A%B8%EC%BB%B7\">애노테이션 트랜잭션 속성과 포인트컷</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/spring/toby-spring/aop/transaction-property/#%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%95%A0%EB%85%B8%ED%85%8C%EC%9D%B4%EC%85%98\">트랜잭션 애노테이션</a></li>\n<li><a href=\"/category/spring/toby-spring/aop/transaction-property/#%EB%8C%80%EC%B2%B4-%EC%A0%95%EC%B1%85\">대체 정책</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/spring/toby-spring/aop/transaction-property/#%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%A7%80%EC%9B%90-%ED%85%8C%EC%8A%A4%ED%8A%B8\">트랜잭션 지원 테스트</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/spring/toby-spring/aop/transaction-property/#%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EB%8F%99%EA%B8%B0%ED%99%94%EC%99%80-%ED%85%8C%EC%8A%A4%ED%8A%B8\">트랜잭션 동기화와 테스트</a></li>\n<li><a href=\"/category/spring/toby-spring/aop/transaction-property/#%EB%A1%A4%EB%B0%B1-%ED%85%8C%EC%8A%A4%ED%8A%B8\">롤백 테스트</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/spring/toby-spring/aop/transaction-property/#%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EC%9C%84%ED%95%9C-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%95%A0%EB%85%B8%ED%85%8C%EC%9D%B4%EC%85%98\">테스트를 위한 트랜잭션 애노테이션</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/spring/toby-spring/aop/transaction-property/#transaction\">@Transaction</a></li>\n<li><a href=\"/category/spring/toby-spring/aop/transaction-property/#rollback\">@Rollback</a></li>\n<li><a href=\"/category/spring/toby-spring/aop/transaction-property/#propagationnever\">Propagation.NEVER</a></li>\n<li><a href=\"/category/spring/toby-spring/aop/transaction-property/#%ED%9A%A8%EA%B3%BC%EC%A0%81%EC%9D%B8-db-%ED%85%8C%EC%8A%A4%ED%8A%B8\">효과적인 DB 테스트</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"/category/spring/toby-spring/aop/transaction-property/#%EB%A7%88%EB%AC%B4%EB%A6%AC\">마무리</a></li>\n</ul>","frontmatter":{"title":"[토비의 스프링] 6-3. AOP - 트랜잭션 속성","description":"AOP, 트랜잭션, 트랜잭션 속성, 전파","date":"2020.07.20","emoji":"🧩","category":"spring"}}},"pageContext":{"slug":"/category/spring/toby-spring/aop/transaction-property/","relatedPosts":[{"node":{"fields":{"slug":"/category/spring/jpa-programming/chapter1-jpa-introduction/"},"frontmatter":{"title":"[JPA 프로그래밍] 1. JPA 소개","date":"2020.10.05","emoji":"🙌🏻","category":"spring"}}},{"node":{"fields":{"slug":"/category/spring/toby-spring/spring-core-technology/"},"frontmatter":{"title":"[토비의 스프링] 7. 스프링 핵심 기술의 응용","date":"2020.07.24","emoji":"🌟","category":"spring"}}},{"node":{"fields":{"slug":"/category/spring/toby-spring/aop/basic-concept/"},"frontmatter":{"title":"[토비의 스프링] 6-2. AOP - 기본 용어","date":"2020.07.16","emoji":"📙","category":"spring"}}},{"node":{"fields":{"slug":"/category/spring/toby-spring/aop/unit-test-and-proxy/"},"frontmatter":{"title":"[토비의 스프링] 6-1. AOP - 단위 테스트와 프록시","date":"2020.07.11","emoji":"ℹ️","category":"spring"}}}]}}}