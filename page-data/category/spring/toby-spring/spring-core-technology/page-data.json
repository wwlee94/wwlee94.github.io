{"componentChunkName":"component---src-templates-post-tsx","path":"/category/spring/toby-spring/spring-core-technology/","result":{"data":{"site":{"siteMetadata":{"title":"Blausee 기술 블로그","author":"wwlee94","siteUrl":"https://wwlee94.github.io"}},"markdownRemark":{"id":"eda86a11-7b1d-56ff-8152-75378ca8021d","excerpt":"개요 7.3 파트에서는 다음과 같은 두 가지 개선 사항을 다룹니다. 자바에는 JAXB 외에도 다양한 XML과 자바 오브젝트를 매핑하는 기술이 있다. 필요에 따라 다른 기술로 손쉽게 바꿔서 사용할 수 있게 해야 한다. XML 파일을 좀 더 다양한 소스에서 가져올 수 있게 만든다. 7.…","html":"<h2 id=\"개요\" style=\"position:relative;\"><a href=\"#%EA%B0%9C%EC%9A%94\" aria-label=\"개요 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>개요</h2>\n<p>7.3 파트에서는 다음과 같은 두 가지 개선 사항을 다룹니다.</p>\n<ul>\n<li>자바에는 JAXB 외에도 다양한 XML과 자바 오브젝트를 매핑하는 기술이 있다.<br>\n필요에 따라 다른 기술로 손쉽게 바꿔서 사용할 수 있게 해야 한다.</li>\n<li>\n<p>XML 파일을 좀 더 다양한 소스에서 가져올 수 있게 만든다.</p>\n<p>7.4 파트에서는 스프링의 DI와 인터페이스의 관계에 대해서 더 자세히 알아 볼 예정입니다.</p>\n</li>\n</ul>\n<h2 id=\"서비스-추상화-적용\" style=\"position:relative;\"><a href=\"#%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B6%94%EC%83%81%ED%99%94-%EC%A0%81%EC%9A%A9\" aria-label=\"서비스 추상화 적용 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>서비스 추상화 적용</h2>\n<h4 id=\"1-oxm-서비스-추상화\" style=\"position:relative;\"><a href=\"#1-oxm-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B6%94%EC%83%81%ED%99%94\" aria-label=\"1 oxm 서비스 추상화 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. OXM 서비스 추상화</h4>\n<p><strong>OXM이란 ?</strong></p>\n<p>XML과 자바 오브젝트를 매핑해서 상호 변환해주는 기술을 <code class=\"language-text\">OXM(Object-XML Mapping)</code>이라고 합니다.</p>\n<hr>\n<p><code class=\"language-text\">JAXB</code>가 비록 JavaSE, JavaEE의 표준이긴 하지만 다음과 같은 다양한 <code class=\"language-text\">OXM</code> 기술이 있습니다.</p>\n<p><code class=\"language-text\">Castor XML</code>, <code class=\"language-text\">JiBX</code>, <code class=\"language-text\">XmlBeans</code>, <code class=\"language-text\">Xstream</code> 은 모두 <code class=\"language-text\">JAXB</code>와 동일하게 XML 바인딩 기술들입니다.</p>\n<p>기능이 같은 여러가지 기술이 존재한다는 이야기는 구체적인 기술과 API에 종속되지 않고 추상화된 레이어와 API를 제공해 구현 기술에 대해 독립적인 코드를 작성하게 해줄 수 있는 <code class=\"language-text\">서비스 추상화</code>가 필요합니다.</p>\n<p>스프링에서는 <code class=\"language-text\">데이터 액세스 기술</code>, <code class=\"language-text\">트랜잭션</code> 등에서 살펴 봤던 것 처럼 <code class=\"language-text\">OXM</code>을 위한 <code class=\"language-text\">서비스 추상화</code> 기능 또한 제공합니다.</p>\n<h5 id=\"oxm-서비스-인터페이스\" style=\"position:relative;\"><a href=\"#oxm-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4\" aria-label=\"oxm 서비스 인터페이스 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>OXM 서비스 인터페이스</h5>\n<p>스프링이 제공하는 <code class=\"language-text\">OXM</code> 추상화 서비스 인터페이스에는 다음과 같은 2가지 인터페이스가 있습니다.</p>\n<ol>\n<li>\n<p>Marshaller: 자바 오브젝트 -> XML 변환</p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Marshaller</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">marshal</span><span class=\"token punctuation\">(</span> <span class=\"token class-name\">Object</span> jaxbElement<span class=\"token punctuation\">,</span> javax<span class=\"token punctuation\">.</span>xml<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">.</span><span class=\"token class-name\">Result</span> result <span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">throws</span> <span class=\"token class-name\">JAXBException</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>XML로 변환할 자바 오브젝트와 결과값을 담을 Result타입의 오브젝트를 넘겨주면 XML 결과를 result에 돌려줍니다.</p>\n</li>\n<li>\n<p>Unmarshaller: XML -> 자바 오브젝트 변환</p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Unmarshaller</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token keyword\">public</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">unmarshal</span><span class=\"token punctuation\">(</span> javax<span class=\"token punctuation\">.</span>xml<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">.</span><span class=\"token class-name\">Source</span> source <span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">throws</span> <span class=\"token class-name\">JAXBException</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Source 타입의 오브젝트를 주면, 설정에서 지정한 OXM 기술을 이용해 자바오브젝트 트리로 변환하고, 루트 오브젝트를 돌려줍니다.</p>\n</li>\n</ol>\n<h5 id=\"jaxb-구현-테스트\" style=\"position:relative;\"><a href=\"#jaxb-%EA%B5%AC%ED%98%84-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"jaxb 구현 테스트 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>JAXB 구현 테스트</h5>\n<p>JAXB를 이용하도록 만들어진 Marshaller, Unmarshaller 구현 클래스는 <code class=\"language-text\">Jaxb2Marshaller</code>입니다.</p>\n<blockquote>\n<p>Marshaller 인터페이스와 Unmarshaller 인터페이스를 모두 구현하고 있다</p>\n</blockquote>\n<p>각 OXM 기술을 변경하더라도 Unmarshaller 타입의 변수를 사용하는 클라이언트 코드들은 수정될 필요가 없어집니다.</p>\n<h4 id=\"2-oxm-서비스-추상화-적용\" style=\"position:relative;\"><a href=\"#2-oxm-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B6%94%EC%83%81%ED%99%94-%EC%A0%81%EC%9A%A9\" aria-label=\"2 oxm 서비스 추상화 적용 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. OXM 서비스 추상화 적용</h4>\n<ul>\n<li>스프링의 OXM 추상화 기능을 이용하는 SqlService를 만들어보자.</li>\n<li>\n<p>SqlReader와 SqlRegistry라는 두 개의 전략을 활용하는 구조를 적용해봤으므로, 이를 그대로 유지하되 SqlReader 구현 오브젝트에 대한 의존관계를 고정시켜버리는 방법을 생각해볼 수 있다.</p>\n<ul>\n<li>SQL을 읽는 방법을 <code class=\"language-text\">OXM으로 제한</code>시켜 OXM을 이용하는 서비스 구조로 최적화 해 <code class=\"language-text\">하나의 빈 설정</code>으로 프로퍼티 설정이 가능 하도록 하기 위해서</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OxmSqlService</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">SqlService</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">OxmSqlReader</span> sqlReader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">OxmSqlReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 의존 관계 고정</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setUnmarshaller</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Unmarshaller</span> unmarshaller<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sqlReader<span class=\"token punctuation\">.</span><span class=\"token function\">setUnmarshaller</span><span class=\"token punctuation\">(</span>unmarshaller<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setSqlmapFile</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> sqlmapFile<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sqlReader<span class=\"token punctuation\">.</span><span class=\"token function\">setSqlmapFile</span><span class=\"token punctuation\">(</span>sqlmapFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getSql</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> key<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">SqlRetrievalFailureException</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// ...</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// 외부에서 사용 못하도록 private 선언</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OxmSqlReader</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">SqlReader</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">private</span> <span class=\"token class-name\">Unmarshaller</span> unmarshaller<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> sqlmapFile<span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setUnmarshaller</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Unmarshaller</span> unmarshaller<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>unmarshaller <span class=\"token operator\">=</span> unmarshaller<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setSqlmapFile</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> sqlmapFile<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sqlmapFile <span class=\"token operator\">=</span> sqlmapFile<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token annotation punctuation\">@Override</span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SqlRegistry</span> sqlRegistry<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// ...</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>OxmSqlService와 OxmSqlReader는 구조적으로는 강하게 결합되어 있지만 논리적으로 명확하게 분리되는 구조입니다.<br>\n밖에서 볼 때는 하나의 오브젝트로 보이지만 내부에서는 의존관계를 가진 두 개의 오브젝트가 깔끔하게 결합돼서 사용됩니다.</p>\n<p>유연성은 조금 손해를 보더라도 내부적으로는 <code class=\"language-text\">낮은 결합도</code>와 <code class=\"language-text\">높은 응집도</code>를 가진 구현을 가집니다.</p>\n<ul>\n<li>낮은 결합도 : OxmSqlService는 모두 인터페이스를 통해 접근하므로</li>\n<li>높은 응집도 : 독점하니 하나의 빈으로 등록 가능</li>\n</ul>\n<h4 id=\"3-위임을-이용한-basesqlservice의-재사용\" style=\"position:relative;\"><a href=\"#3-%EC%9C%84%EC%9E%84%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-basesqlservice%EC%9D%98-%EC%9E%AC%EC%82%AC%EC%9A%A9\" aria-label=\"3 위임을 이용한 basesqlservice의 재사용 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 위임을 이용한 BaseSqlService의 재사용</h4>\n<p>OxmSqlService와 BaseSqlService의 <code class=\"language-text\">loadSql()</code> 메소드와 <code class=\"language-text\">getSql()</code> 메소드가 중복이 생기는 문제점 발생 !</p>\n<p>물론 이정도의 중복은 무시해도 괜찮지만 <code class=\"language-text\">loadSql()</code>와 <code class=\"language-text\">getSql()</code> 메소드의 작업이 매우 복잡하다면 ?</p>\n<ul>\n<li>수정이 필요할 때마다 양쪽을 함께 변경해야하고 실수할 가능성도 높아짐</li>\n</ul>\n<h5 id=\"해결-방법\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95\" aria-label=\"해결 방법 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해결 방법</h5>\n<p>이런 경우에는 <code class=\"language-text\">위임 구조</code>를 이용해 코드의 중복을 제거할 수 있습니다.</p>\n<p>위임 구조라면, <code class=\"language-text\">프록시</code>를 만들 때 사용해봤습니다.<br>\n하지만, 위임구조를 만들기 위해 OxmSqlService와 BaseSqlService 두 개를 빈으로 등록하는 것은 불편한 일이고 부가기능 프록시처럼 많은 타깃에 적용할 것도 아니고 특화된 서비스를 위해 한 번만 사용할 것이기 때문에 유연한 DI방식이 아닌 두 개의 클래스를 하나로 묶는 방법을 설계합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.8936170212766%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABJUlEQVQoz11SC8+CMAzc//9xH4aEGCAC8pA3REF5qafXOLJ8S452a9fedajX64X/eL/fGMcBcRzDOhwQRREejwe4dJww87VV/JhLJ0/ThK7r4Lru17ZYlgXP5xPbtu2Xdb7ZRDGp73s0TYOiKAT0eda2LdI0RVVVsmfRdV2/7EcMwyB7NjDZKjIJwxCO4wgbz/OQJLEwZOEgCJFlmfjX6xXncwTbtuH7/jcWSDNTmWI3dmeAqOt6Z8xCSZL8mOcyAiLP8x3Mm+dZQLXqfr+LBF2YAcpi8uVy+dlMHogxzYaFXNcTdcfjEafTCbfbDYq6WYwbzoyyiLIspQjl8RILkIGeG5uTOUdDAjyXGZqvzEQGaeu6kt/Fsv6ke9s2EtPy6Juz0/4H1Ktj26Zt1SoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"그림 1\"\n        title=\"그림 1\"\n        src=\"/static/eb16a6bae513c51242058317e961e45c/1d69c/image-1.png\"\n        srcset=\"/static/eb16a6bae513c51242058317e961e45c/4dcb9/image-1.png 188w,\n/static/eb16a6bae513c51242058317e961e45c/5ff7e/image-1.png 375w,\n/static/eb16a6bae513c51242058317e961e45c/1d69c/image-1.png 750w,\n/static/eb16a6bae513c51242058317e961e45c/709cb/image-1.png 1034w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<hr>\n<p>아래 코드는 위임 구조를 이용한 OxmSqlService 코드입니다.</p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OxmSqlService</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">SqlService</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">OxmSqlReader</span> sqlReader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">OxmSqlReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">BaseSqlService</span> sqlService <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BaseSqlService</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">SqlRegistry</span> sqlRegistry <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HashMapSqlRegistry</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setSqlRegistry</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SqlRegistry</span> sqlRegistry<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sqlRegistry <span class=\"token operator\">=</span> sqlRegistry<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setUnmarshaller</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Unmarshaller</span> unmarshaller<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sqlReader<span class=\"token punctuation\">.</span><span class=\"token function\">setUnmarshaller</span><span class=\"token punctuation\">(</span>unmarshaller<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setSqlmapFile</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> sqlmapFile<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sqlReader<span class=\"token punctuation\">.</span><span class=\"token function\">setSqlmapFile</span><span class=\"token punctuation\">(</span>sqlmapFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// 빈 후처리 시 위임을 이용한 초기화</span>\n    <span class=\"token annotation punctuation\">@PostConstruct</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">loadSql</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sqlService<span class=\"token punctuation\">.</span><span class=\"token function\">setSqlReader</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sqlReader<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sqlService<span class=\"token punctuation\">.</span><span class=\"token function\">setSqlRegistry</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sqlRegistry<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sqlService<span class=\"token punctuation\">.</span><span class=\"token function\">loadSql</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">getSql</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> key<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">SqlRetrievalFailureException</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> sqlService<span class=\"token punctuation\">.</span><span class=\"token function\">getSql</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"3-리소스-추상화\" style=\"position:relative;\"><a href=\"#3-%EB%A6%AC%EC%86%8C%EC%8A%A4-%EC%B6%94%EC%83%81%ED%99%94\" aria-label=\"3 리소스 추상화 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 리소스 추상화</h2>\n<p>위의 추상화 접근과 동일하게 리소드 또한 리소스에 접근할 방법이 <code class=\"language-text\">클래스 패스</code>, <code class=\"language-text\">파일 시스템</code>, <code class=\"language-text\">http</code>, <code class=\"language-text\">ftp</code> 프로토콜 등 여러가지가 있습니다.</p>\n<p>스프링은 이러한 여러 기술에 종속적이지 않도록 자바에 존재하는 일관성 없는 <code class=\"language-text\">리소스 접근 API</code>를 추상화해서 <code class=\"language-text\">Resource</code>라는 추상화 인터페이스를 제공합니다.</p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Resource</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">InputStreamSource</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 리소스의 존재나 읽기 가능한지에 대한 여부 확인 가능 or 스트림이 열려 있는지 확인 가능</span>\n\t<span class=\"token keyword\">boolean</span> <span class=\"token function\">exists</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">boolean</span> <span class=\"token function\">isReadable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">boolean</span> <span class=\"token function\">isOpen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// JDK의 URI, URL, File 형태로 전환 가능한 리소스에 사용</span>\n\t<span class=\"token class-name\">URL</span> <span class=\"token function\">getURL</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token class-name\">URI</span> <span class=\"token function\">getURI</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token class-name\">File</span> <span class=\"token function\">getFile</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 리소스에 대한 이름과 부가적인 정보 제공</span>\n    <span class=\"token keyword\">long</span> <span class=\"token function\">lastModified</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token class-name\">String</span> <span class=\"token function\">getFilename</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token class-name\">String</span> <span class=\"token function\">getDescription</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">InputStreamSource</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 모든 리소스는 InputStream형태로 가져올 수 있다.</span>\n    <span class=\"token class-name\">InputStream</span> <span class=\"token function\">getInputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li><code class=\"language-text\">애플리케이션 컨텍스트</code>가 사용할 설정정보 파일을 지정하는 것부터 시작해서 스프링의 거의 모든 API는 외부의 리소스 정보가 필요할 때는 항상 이 <code class=\"language-text\">Resource 추상화</code>를 이용합니다.</li>\n<li>Resource는 스프링에서 빈이 아니라 <code class=\"language-text\">값</code>으로 취급됩니다.\n리소스는 OXM이나 트랜잭션처럼 서비스를 제공해주는 것이 아니라 단순한 정보를 가진 값으로 지정합니다.</li>\n</ul>\n<p>값으로 취급하기 때문에 <code class=\"language-text\">&lt;property&gt;</code>를 통해서만 가능합니다.<br>\n하지만, <code class=\"language-text\">value</code> 애트리뷰트는 단순한 문자열만 넣을 수 있습니다.</p>\n<h5 id=\"리소스-로더\" style=\"position:relative;\"><a href=\"#%EB%A6%AC%EC%86%8C%EC%8A%A4-%EB%A1%9C%EB%8D%94\" aria-label=\"리소스 로더 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>리소스 로더</h5>\n<p>그래서 스프링에는 URL 클래스와 유사하게 접두어를 이용해 Resource 오브젝트를 선언하는 방법을 제공합니다.</p>\n<ul>\n<li>\n<p><code class=\"language-text\">classpath:</code></p>\n<ul>\n<li>클래스패스 루트부터 절대위치</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">file:</code></p>\n<ul>\n<li>파일 시스템 루트 디렉토리부터 시작하는 위치</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">http:</code></p>\n<ul>\n<li>접근 가능한 웹 리소스 위치</li>\n</ul>\n</li>\n</ul>\n<p>ResourceLoader의 대표적인 예는 바로 스프링의 애플리케이션 컨텍스트입니다.<br>\n스프링 설정 정보가 담긴 XML 파일도 리소스 로더를 이용해 Resource 형태로 읽어옵니다.</p>\n<h2 id=\"인터페이스-상속을-통한-안전한-기능-확장\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4-%EC%83%81%EC%86%8D%EC%9D%84-%ED%86%B5%ED%95%9C-%EC%95%88%EC%A0%84%ED%95%9C-%EA%B8%B0%EB%8A%A5-%ED%99%95%EC%9E%A5\" aria-label=\"인터페이스 상속을 통한 안전한 기능 확장 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인터페이스 상속을 통한 안전한 기능 확장</h2>\n<p>만약, 애플리케이션을 새로 시작하지 않고 특정 SQL의 내용만을 변경하고 싶다면 어떻게 해야 할지 <code class=\"language-text\">스프링 답게</code> 접근하는 방법이 무엇인지 생각해봅시다.</p>\n<h4 id=\"1-di와-기능의-확장\" style=\"position:relative;\"><a href=\"#1-di%EC%99%80-%EA%B8%B0%EB%8A%A5%EC%9D%98-%ED%99%95%EC%9E%A5\" aria-label=\"1 di와 기능의 확장 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. DI와 기능의 확장</h4>\n<p>스프링과 같은 DI 프레임워크를 적용하고 빈 설정파일을 이용해 애플리케이션을 구성했다고 해서 <code class=\"language-text\">DI</code>를 바르게 활용하고 있다고 볼 수는 없습니다.<br>\n<code class=\"language-text\">DI</code>의 가치를 제대로 얻으려면 먼저 <code class=\"language-text\">DI</code>에 적합한 오브젝트 설계가 필요하다.</p>\n<h5 id=\"di를-의식하는-설계\" style=\"position:relative;\"><a href=\"#di%EB%A5%BC-%EC%9D%98%EC%8B%9D%ED%95%98%EB%8A%94-%EC%84%A4%EA%B3%84\" aria-label=\"di를 의식하는 설계 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DI를 의식하는 설계</h5>\n<p>객체 지향 설계를 잘하는 방법은 다양하겠지만, 그중에서 추천하고 싶은 한가지는 바로 <code class=\"language-text\">DI</code>를 의식하면서 설계하는 방식입니다.</p>\n<ul>\n<li><code class=\"language-text\">DI</code>는 런타임시에 의존 오브젝트를 다이내믹하게 연결해줘서 유연한 확장을 꾀하는게 목적이기 때문에 항상 확장을 염두에 두고 오브젝트 사이의 관계를 생각해야 합니다.</li>\n<li><code class=\"language-text\">DI</code>는 확장을 위해 필요한 것이므로 항상 미래에 일어날 변화를 예상하고 고민해야 적합한 설계가 가능해집니다.</li>\n</ul>\n<p><strong>DI란 결국 미래를 프로그래밍하는 것이다.</strong></p>\n<h5 id=\"di와-인터페이스-프로그래밍\" style=\"position:relative;\"><a href=\"#di%EC%99%80-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D\" aria-label=\"di와 인터페이스 프로그래밍 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DI와 인터페이스 프로그래밍</h5>\n<p>DI를 적용할 때는 가능한 한 <code class=\"language-text\">인터페이스</code>를 사용하게 해야 합니다.</p>\n<p>인터페이스를 사용해야하는 이유는 2가지가 있습니다.</p>\n<ol>\n<li>\n<p>다형성을 얻기 위해서</p>\n<ul>\n<li>하나의 인터페이스를 통해 여러 개의 구현을 바꿔가면서 사용할 수 있게 하는 것이 DI가 추구하는 첫번째 목적</li>\n</ul>\n</li>\n<li>\n<p>인터페이스 분리 원칙을 통해 클라이언트와 의존 오브젝트 사이의 관계를 명확하게 해줄 수 있기 때문</p>\n<ul>\n<li>A와 B가 인터페이스로 연결되었다는 의미는 A는 B를 해당 인터페이스라는 <code class=\"language-text\">창</code>을 통해서만 바라본다는 뜻</li>\n</ul>\n</li>\n</ol>\n<p>DI는 특별한 이유가 없는 한 항상 인터페이스를 사용한다고 기억해둡시다 !</p>\n<hr>\n<p><strong># 인터페이스 분리 원칙이란?</strong></p>\n<p>오브젝트가 그 자체로 충분히 응집도가 높은 작은 단위로 설계됐더라도, 목적과 관심이 각기 다른 클라이언트가 있다면 인터페이스를 통해 이를 적절하게 분리해줄 필요가 있고 이를 객체지향 설계 원칙에서는 <code class=\"language-text\">인터페이스 분리 원칙</code>이라고 부릅니다.</p>\n<h4 id=\"2-인터페이스-상속\" style=\"position:relative;\"><a href=\"#2-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4-%EC%83%81%EC%86%8D\" aria-label=\"2 인터페이스 상속 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 인터페이스 상속</h4>\n<p>BaseSqlService는 SqlReader와 SqlRegistry라는 두 개의 인터페이스를 통해 의존 오브젝트들을 DI 하도록 되어 있고 아래 그림은 인터페이스와 DI가 적용된 전형적인 구조를 보여줍니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.42553191489361%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABFElEQVQoz21Q2YqDQBDM/3+Z4NsGjLo6hujGI97BO1q71TAmLDY0Le10Xadt2/DZrHVdZW7bimmaMAwD5nmWPd/oedQn/lyWRZpHBOCPrusQxzF834dpmgjDUHaakGSHgG3b4nKxYds2lFKIogh1XcvxOI7ynec5ns9WCLXCo94Bo+gHj8dDDu/3u4DQJmeapkiSBFmW7QqPlGnlYpk2+76X7rpelJHoer3CdV0YhoEgCFBVFfT7z5her9ce1YnIylc4f50lL8/z/kC+BYAKmR3jYJ5N0wgB35HMsiy4jgvH4U69AWmH1nhAVjKyNJgGYCycnueLWpIwJt4XRfG2rEvnoXfMjqAkC8MbyrIUazrL/8XbX/mIZWNPdfaLAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"그림 2\"\n        title=\"그림 2\"\n        src=\"/static/1a4b78d16a86db7aabbb14b14c6a00a0/1d69c/image-2.png\"\n        srcset=\"/static/1a4b78d16a86db7aabbb14b14c6a00a0/4dcb9/image-2.png 188w,\n/static/1a4b78d16a86db7aabbb14b14c6a00a0/5ff7e/image-2.png 375w,\n/static/1a4b78d16a86db7aabbb14b14c6a00a0/1d69c/image-2.png 750w,\n/static/1a4b78d16a86db7aabbb14b14c6a00a0/218a4/image-2.png 1052w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>이렇게 인터페이스 분리 원칙이 주는 장점은 2가지가 있습니다.</p>\n<ol>\n<li>모든 클라이언트가 자신의 관심에 따른 접근 방식을 불필요한 간섭 없이 유지할 수 있다는 점</li>\n<li>SqlRegistry의 구현 클래스인 MySqlRegistry의 오브젝트가 또 다른 제3의 클라이언트를 위한 인터페이스를 가질 수 있다는 점</li>\n</ol>\n<hr>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">SqlRegistry</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">void</span> <span class=\"token function\">registerSql</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> key<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> vale<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">String</span> <span class=\"token function\">findSql</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> key<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">SqlNotFoundException</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>여기에 이미 등록된 SQL을 변경할 수 있는 기능을 넣어서 확장하고 싶다고 생각해볼때, 기존의 인터페이스에 기능을 추가하는 것은 바람직하지 않습니다.</li>\n<li>새롭게 추가하는 기능은 새로운 인터페이스에 기존 <code class=\"language-text\">SqlRegistry</code>를 상속 받아 확장하는 게 바람직합니다.</li>\n</ul>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">UpdatableSqlRegistry</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">SqlRegistry</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">void</span> <span class=\"token function\">updateSql</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> key<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> value<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">SqlUpdateFailureException</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">void</span> <span class=\"token function\">updateSql</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> sqls<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">SqlUpdateFailureException</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>아마도 관리자가 사용할 SQL 관리 기능을 받은 오브젝트가 새로운 클라이언트가 될 것입니다.</li>\n</ul>\n<p>새로운 관리 기능을 받은 클래스를 <code class=\"language-text\">SqlAdminService</code>라고 하고 새로운 SQL 업데이트 기능을 구현한 SQL 클래스를 <code class=\"language-text\">MyUpdateSqlRegistry</code> 라고 하면 구조는 다음과 같습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.340425531914896%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAwABBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAelgoPHH/8QAFxAAAwEAAAAAAAAAAAAAAAAAAAECEP/aAAgBAQABBQJkvGRn/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGRABAAMBAQAAAAAAAAAAAAAAAQAQMVGh/9oACAEBAAE/IWDQPX2bmK//2gAMAwEAAgADAAAAEMDP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHhABAAECBwAAAAAAAAAAAAAAAQARYRAhMXGhscH/2gAIAQEAAT8QcI8xQQSt1ipm1tGpt7O3D//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"그림 3\"\n        title=\"그림 3\"\n        src=\"/static/4f43e78194028765896b75161d41b9d3/acb04/image-3.jpg\"\n        srcset=\"/static/4f43e78194028765896b75161d41b9d3/bc01b/image-3.jpg 188w,\n/static/4f43e78194028765896b75161d41b9d3/bf173/image-3.jpg 375w,\n/static/4f43e78194028765896b75161d41b9d3/acb04/image-3.jpg 750w,\n/static/4f43e78194028765896b75161d41b9d3/ec605/image-3.jpg 1125w,\n/static/4f43e78194028765896b75161d41b9d3/c58a3/image-3.jpg 1500w,\n/static/4f43e78194028765896b75161d41b9d3/bb587/image-3.jpg 3594w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>중요한 것은 클라이언트가 정말 필요한 기능을 가진 인터페이스를 통해 오브젝트에 접근하도록 만들었는가입니다.</p>\n<p><em>잘 적용된 DI는 결국 잘 설계된 오브젝트 의존관계에 달려 있습니다.<br>\n인터페이스를 적절하게 분리하고 확장하는 방법을 통해 오브젝트 사이의 의존관계를 명확하게 해주고, 기존 의존관계에 영향을 주지 않으면서 유연한 확장성을 얻는 방법이 무엇인지 항상 고민해야 합니다.</em></p>","tableOfContents":"<ul>\n<li><a href=\"/category/spring/toby-spring/spring-core-technology/#%EA%B0%9C%EC%9A%94\">개요</a></li>\n<li>\n<p><a href=\"/category/spring/toby-spring/spring-core-technology/#%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B6%94%EC%83%81%ED%99%94-%EC%A0%81%EC%9A%A9\">서비스 추상화 적용</a></p>\n<ul>\n<li>\n<ul>\n<li>\n<p><a href=\"/category/spring/toby-spring/spring-core-technology/#1-oxm-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B6%94%EC%83%81%ED%99%94\">1. OXM 서비스 추상화</a></p>\n<ul>\n<li><a href=\"/category/spring/toby-spring/spring-core-technology/#oxm-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4\">OXM 서비스 인터페이스</a></li>\n<li><a href=\"/category/spring/toby-spring/spring-core-technology/#jaxb-%EA%B5%AC%ED%98%84-%ED%85%8C%EC%8A%A4%ED%8A%B8\">JAXB 구현 테스트</a></li>\n</ul>\n</li>\n<li><a href=\"/category/spring/toby-spring/spring-core-technology/#2-oxm-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%B6%94%EC%83%81%ED%99%94-%EC%A0%81%EC%9A%A9\">2. OXM 서비스 추상화 적용</a></li>\n<li>\n<p><a href=\"/category/spring/toby-spring/spring-core-technology/#3-%EC%9C%84%EC%9E%84%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-basesqlservice%EC%9D%98-%EC%9E%AC%EC%82%AC%EC%9A%A9\">3. 위임을 이용한 BaseSqlService의 재사용</a></p>\n<ul>\n<li><a href=\"/category/spring/toby-spring/spring-core-technology/#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95\">해결 방법</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/spring/toby-spring/spring-core-technology/#3-%EB%A6%AC%EC%86%8C%EC%8A%A4-%EC%B6%94%EC%83%81%ED%99%94\">3. 리소스 추상화</a></p>\n<ul>\n<li>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/spring/toby-spring/spring-core-technology/#%EB%A6%AC%EC%86%8C%EC%8A%A4-%EB%A1%9C%EB%8D%94\">리소스 로더</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"/category/spring/toby-spring/spring-core-technology/#%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4-%EC%83%81%EC%86%8D%EC%9D%84-%ED%86%B5%ED%95%9C-%EC%95%88%EC%A0%84%ED%95%9C-%EA%B8%B0%EB%8A%A5-%ED%99%95%EC%9E%A5\">인터페이스 상속을 통한 안전한 기능 확장</a></p>\n<ul>\n<li>\n<ul>\n<li>\n<p><a href=\"/category/spring/toby-spring/spring-core-technology/#1-di%EC%99%80-%EA%B8%B0%EB%8A%A5%EC%9D%98-%ED%99%95%EC%9E%A5\">1. DI와 기능의 확장</a></p>\n<ul>\n<li><a href=\"/category/spring/toby-spring/spring-core-technology/#di%EB%A5%BC-%EC%9D%98%EC%8B%9D%ED%95%98%EB%8A%94-%EC%84%A4%EA%B3%84\">DI를 의식하는 설계</a></li>\n<li><a href=\"/category/spring/toby-spring/spring-core-technology/#di%EC%99%80-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D\">DI와 인터페이스 프로그래밍</a></li>\n</ul>\n</li>\n<li><a href=\"/category/spring/toby-spring/spring-core-technology/#2-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4-%EC%83%81%EC%86%8D\">2. 인터페이스 상속</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"[토비의 스프링] 7. 스프링 핵심 기술의 응용","description":"","date":"2020.07.22","emoji":"🌟","category":"spring"}}},"pageContext":{"slug":"/category/spring/toby-spring/spring-core-technology/","relatedPosts":[{"node":{"fields":{"slug":"/category/spring/toby-spring/aop/transaction-property/"},"frontmatter":{"title":"[토비의 스프링] 6-3. AOP - 트랜잭션 속성","date":"2020.07.20","emoji":"🧩","category":"spring"}}},{"node":{"fields":{"slug":"/category/spring/toby-spring/aop/basic-concept/"},"frontmatter":{"title":"[토비의 스프링] 6-2. AOP - 기본 용어","date":"2020.07.16","emoji":"📙","category":"spring"}}},{"node":{"fields":{"slug":"/category/spring/toby-spring/aop/unit-test-and-proxy/"},"frontmatter":{"title":"[토비의 스프링] 6-1. AOP - 단위 테스트와 프록시","date":"2020.07.11","emoji":"ℹ️","category":"spring"}}},{"node":{"fields":{"slug":"/category/spring/toby-spring/service-abstraction/mockup-test/"},"frontmatter":{"title":"[토비의 스프링] 5-2. 단일 책임 원칙과 테스트 추상화","date":"2020.07.07","emoji":"⚠️","category":"spring"}}}]}}}