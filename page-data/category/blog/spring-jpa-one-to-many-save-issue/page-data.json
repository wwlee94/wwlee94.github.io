{"componentChunkName":"component---src-templates-post-tsx","path":"/category/blog/spring-jpa-one-to-many-save-issue/","result":{"data":{"site":{"siteMetadata":{"title":"Blausee ê¸°ìˆ  ë¸”ë¡œê·¸","author":"wwlee94","siteUrl":"https://wwlee94.github.io"}},"markdownRemark":{"id":"177373df-2dc1-5150-9d1c-2457548e3e22","excerpt":"ê°œìš”  â€˜Party-ingâ€™ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë˜ ë„ì¤‘  ê´€ê³„ë¥¼ ê°€ì§€ëŠ” ì—”í‹°í‹°ë¥¼ Save í•  ë•Œ 2ê°œì˜ í…Œì´ë¸”ì— ë°ì´í„°ëŠ” ì˜ ìƒì„±ë˜ì—ˆìœ¼ë‚˜ Save ì¿¼ë¦¬ë¬¸ ë¿ ì•„ë‹ˆë¼ Updateâ€¦","html":"<h2 id=\"ê°œìš”\" style=\"position:relative;\"><a href=\"#%EA%B0%9C%EC%9A%94\" aria-label=\"ê°œìš” permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê°œìš”</h2>\n<p><code class=\"language-text\">ë£¨ë¹„ì½˜ 2ê¸°</code> â€˜Party-ingâ€™ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë˜ ë„ì¤‘ <code class=\"language-text\">1:N</code> ê´€ê³„ë¥¼ ê°€ì§€ëŠ” ì—”í‹°í‹°ë¥¼ Save í•  ë•Œ 2ê°œì˜ í…Œì´ë¸”ì— ë°ì´í„°ëŠ” ì˜ ìƒì„±ë˜ì—ˆìœ¼ë‚˜ Save ì¿¼ë¦¬ë¬¸ ë¿ ì•„ë‹ˆë¼ Update ì¿¼ë¦¬ë¬¸ì´ ì¶”ê°€ë¡œ ë°œìƒë˜ëŠ” ì´ìŠˆë¥¼ ê²½í—˜í•´ì„œ í•´ê²° ë°©ë²•ì„ ê³µìœ í•˜ê³ ì í•©ë‹ˆë‹¤.</p>\n<h2 id=\"í˜„ì¬-ì´ìŠˆ-ë°œìƒ-ìƒí™©\" style=\"position:relative;\"><a href=\"#%ED%98%84%EC%9E%AC-%EC%9D%B4%EC%8A%88-%EB%B0%9C%EC%83%9D-%EC%83%81%ED%99%A9\" aria-label=\"í˜„ì¬ ì´ìŠˆ ë°œìƒ ìƒí™© permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>í˜„ì¬ ì´ìŠˆ ë°œìƒ ìƒí™©</h2>\n<p>ì—”í‹°í‹° ì •ë³´ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>\n<p><strong>Review ì—”í‹°í‹°</strong></p>\n<ul>\n<li>reviewer ìœ ì €ê°€ target ìœ ì €ì—ê²Œ ë¦¬ë·°ë¥¼ ë‚¨ê²¼ë‹¤ëŠ” ì •ë³´ë¥¼ ê°€ì§€ëŠ” ê´€ê³„ ì—”í‹°í‹°</li>\n</ul>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Review</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span>IDENTITY<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> reviewId<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@ManyToOne</span><span class=\"token punctuation\">(</span>fetch <span class=\"token operator\">=</span> <span class=\"token class-name\">FetchType</span><span class=\"token punctuation\">.</span>LAZY<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JoinColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"reviewerId\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">User</span> reviewer<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@ManyToOne</span><span class=\"token punctuation\">(</span>fetch <span class=\"token operator\">=</span> <span class=\"token class-name\">FetchType</span><span class=\"token punctuation\">.</span>LAZY<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JoinColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"targetId\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">User</span> target<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@OneToMany</span><span class=\"token punctuation\">(</span>cascade <span class=\"token operator\">=</span> <span class=\"token class-name\">CascadeType</span><span class=\"token punctuation\">.</span>ALL<span class=\"token punctuation\">,</span> orphanRemoval <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JoinColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"reviewId\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Rating</span><span class=\"token punctuation\">></span></span> rating<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">Review</span> <span class=\"token function\">of</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span> reviewer<span class=\"token punctuation\">,</span> <span class=\"token class-name\">User</span> target<span class=\"token punctuation\">,</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Rating</span><span class=\"token punctuation\">></span></span> rating<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Review</span><span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">reviewer</span><span class=\"token punctuation\">(</span>reviewer<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">target</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">rating</span><span class=\"token punctuation\">(</span>rating<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>Rating ì—”í‹°í‹°</strong></p>\n<ul>\n<li>í•˜ë‚˜ì˜ ë¦¬ë·° ë‚´ìš©ì„ ê°€ì§€ê³  ìˆëŠ” ì—”í‹°í‹°</li>\n</ul>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Rating</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span>IDENTITY<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> ratingId<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> length <span class=\"token operator\">=</span> <span class=\"token number\">45</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@Enumerated</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">EnumType</span><span class=\"token punctuation\">.</span>STRING<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Content</span> content<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">Rating</span> <span class=\"token function\">of</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Content</span> content<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Rating</span><span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">content</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>ì‹¤í–‰ë˜ëŠ” ì„œë¹„ìŠ¤ ì½”ë“œ</strong></p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token comment\">/**\n* íŠ¹ì • ì‚¬ìš©ìì—ê²Œ ë¦¬ë·°í•˜ê¸°\n* @param reviewerId : ë¦¬ë·° í•˜ëŠ” ì‚¬ìš©ì ID (í˜„ì¬ ì‚¬ìš©ì)\n* @param targetId : ë¦¬ë·° í•  ì‚¬ìš©ì ID\n* @param reviewDto : ë¦¬ë·° ë‚´ìš© DTO\n*/</span>\n<span class=\"token annotation punctuation\">@Transactional</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">review</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> reviewerId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Long</span> targetId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">ReviewRequest</span> reviewDto<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">User</span> reviewer <span class=\"token operator\">=</span> userRepository<span class=\"token punctuation\">.</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>reviewerId<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UserNotFoundException</span><span class=\"token operator\">::</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">User</span> target <span class=\"token operator\">=</span> userRepository<span class=\"token punctuation\">.</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>targetId<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UserNotFoundException</span><span class=\"token operator\">::</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">Optional</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Review</span><span class=\"token punctuation\">></span></span> optional <span class=\"token operator\">=</span> reviewQueryRepository<span class=\"token punctuation\">.</span><span class=\"token function\">exists</span><span class=\"token punctuation\">(</span>reviewerId<span class=\"token punctuation\">,</span> targetId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>optional<span class=\"token punctuation\">.</span><span class=\"token function\">isPresent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ReviewDuplicatedException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">Review</span> review <span class=\"token operator\">=</span> <span class=\"token class-name\">Review</span><span class=\"token punctuation\">.</span><span class=\"token function\">of</span><span class=\"token punctuation\">(</span>reviewer<span class=\"token punctuation\">,</span> target<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Rating</span><span class=\"token punctuation\">></span></span> ratingList <span class=\"token operator\">=</span> reviewDto<span class=\"token punctuation\">.</span><span class=\"token function\">getRatingList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    ratingList<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>rating <span class=\"token operator\">-></span> review<span class=\"token punctuation\">.</span><span class=\"token function\">getRating</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>rating<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    reviewRepository<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>review<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"ì‹¤í–‰-ê²°ê³¼\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%ED%96%89-%EA%B2%B0%EA%B3%BC\" aria-label=\"ì‹¤í–‰ ê²°ê³¼ permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì‹¤í–‰ ê²°ê³¼</h4>\n<p>API ì½œì„ ë³´ë‚´ì„œ ìœ„ì˜ ì„œë¹„ìŠ¤ ì½”ë“œë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì¿¼ë¦¬ë¬¸ì´ ë°œìƒí•©ë‹ˆë‹¤.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d653b8466fa6bebcebde2c55461eec3d/d9b5d/api-call.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.255319148936174%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABZklEQVQoz61S2XKDMAzkY1oOY2OMD86Q4wWm//8/W0kJmUw7een0YdHo9K5Q1jQNbrcblmXB9XrFuq6CGCPyPEdRFCjL8hc4zvmfyEIIMqDve0zTJJjnGeM4ylDnHKy1aNtW7Dsc+exyuWDbtucgZrlvO/b9Ds4neiymHsMwyMMH2D9wxDKWzNBaI/gA5zt8qgK1quE6hw+Vo9E1lqmHMpUw8d4L6rqWXraelFrKZUyTZXMipSRsjG0kxrJd8DiPCV+nHufkpKmnuq7rRCKzs9QbTQ1DpDJmxnsSpsagpSJdaylqaTBbR82KGBtiwmysve/LUH2gPXOvVSVUVSGr6MOJ1tFiY4IfJpiGCsmm9Qo/zmiIVZxPd38YaaiiP12gqsqnrVRFjz4GatpRIjkxUmPqaD8sv0MagvghWFoF+558R3lDkjV8Z16gJZYdNyXgu3vc3uttvfpH/h2E4bvj/QueDP9r4Dc1K1SYXly9gwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"API ì½œ\"\n        title=\"API ì½œ\"\n        src=\"/static/d653b8466fa6bebcebde2c55461eec3d/1d69c/api-call.png\"\n        srcset=\"/static/d653b8466fa6bebcebde2c55461eec3d/4dcb9/api-call.png 188w,\n/static/d653b8466fa6bebcebde2c55461eec3d/5ff7e/api-call.png 375w,\n/static/d653b8466fa6bebcebde2c55461eec3d/1d69c/api-call.png 750w,\n/static/d653b8466fa6bebcebde2c55461eec3d/78797/api-call.png 1125w,\n/static/d653b8466fa6bebcebde2c55461eec3d/d9b5d/api-call.png 1224w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f7cd821b8b49940c93bc482a933483ca/2cefc/issue.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.42553191489361%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABPUlEQVQoz1VR23aDMAzjjwpbKXcoJCFcBi0t69n//4hmZaWjDzmyFVuWE68oS4zjiKZpYK2FUgrGGHRd55C81trlvCNu+cZtPOu9OElgpGBrJNZ17S5LGXY6nRBFEdI0RSK1cRy7nMic8T73qqrCsixuwjzPGIbBHcZ0zAGbYw7s+/7NIeM3h1meOwGSFCDZtu1LbHOXS93miDG5LMvcIc+cG3lpkqIVESXNRVEgPB53a0VIditm0kTM838h3vFZwjD8W1mZFvd1hRFXvTht+TGyxiAfZST+miaHlutJTSRNiYjx7Sni+z4Oh8MLvUnVeEwj+nOFqzWYtJLT4NJqzEY7bhZu6Sy6skAtrqvjB4KnSBAEb8e7lRm+2Sz4sBqXqsCqa5dfzwXu6uy4pa6Ey/HTW6xlik9fBJ8ie+FfIIkXHm7wqUEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"issue\"\n        title=\"issue\"\n        src=\"/static/f7cd821b8b49940c93bc482a933483ca/1d69c/issue.png\"\n        srcset=\"/static/f7cd821b8b49940c93bc482a933483ca/4dcb9/issue.png 188w,\n/static/f7cd821b8b49940c93bc482a933483ca/5ff7e/issue.png 375w,\n/static/f7cd821b8b49940c93bc482a933483ca/1d69c/issue.png 750w,\n/static/f7cd821b8b49940c93bc482a933483ca/78797/issue.png 1125w,\n/static/f7cd821b8b49940c93bc482a933483ca/2cefc/issue.png 1400w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>DB í…Œì´ë¸” ì •ë³´ë¥¼ ë³´ë©´ ê²°ê³¼ëŠ” ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c7bda0a1909fa38cb2e0d1848aaeb6e6/41870/result.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.51063829787234%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABpUlEQVQoz42SaW7bMBCFeSFrMap9sfaNFK1YcougcVrHvv8VXoaSnThBnebHh9k4A3DesFxskcsRJZfoH0aI7UB2h37Ykf+AVkjI3R58GCGpPox79LsJj89HHF7OeDqecDieiROmxycwSc2Smrt+i6oTKLseXA7kc+R1i5oGtlRLyc+qGlXLUbYdCopLetPwHo3oUXOBounA0jRBUVZIsxxeGCIuKmTkJ0kKP4qxKWvkeQHP82AYBkzTfMcw59wVlWO6rkPTNOiXpK58YnmkLzG9MQzz47A7MF1bzU0aWW21ujQbd/iqtsCiNEOc5gtZAT+MYNk2LMeBfcGyydqLnWszt76NH9aSYz//nDEdXjD+/ov98wntMM3KqmWrJZeEEqUUAy1+uQSu1KccV9dAsUKS8g31MS4EhNyiIcVqUq8mW1TNrHBFJ9WSejkJE8QJwk2CmMSKNooEEfnxDSrHXNeBHwQI6Kvq7obpF3zfpy9YcIKQ/ACO68JQuyX0L1B1dg2UQmoHjuthvV5/GPAddd9Uvg2uAz7f2+2d/XfgvYf/yn9n6CsPw5beE8wTlQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"DB ê²°ê³¼\"\n        title=\"DB ê²°ê³¼\"\n        src=\"/static/c7bda0a1909fa38cb2e0d1848aaeb6e6/1d69c/result.png\"\n        srcset=\"/static/c7bda0a1909fa38cb2e0d1848aaeb6e6/4dcb9/result.png 188w,\n/static/c7bda0a1909fa38cb2e0d1848aaeb6e6/5ff7e/result.png 375w,\n/static/c7bda0a1909fa38cb2e0d1848aaeb6e6/1d69c/result.png 750w,\n/static/c7bda0a1909fa38cb2e0d1848aaeb6e6/78797/result.png 1125w,\n/static/c7bda0a1909fa38cb2e0d1848aaeb6e6/aa440/result.png 1500w,\n/static/c7bda0a1909fa38cb2e0d1848aaeb6e6/41870/result.png 1788w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Insert ì¿¼ë¦¬ ì‘ì—…ë§Œìœ¼ë¡œ í…Œì´ë¸”ì„ ìƒì„±í•  ìˆ˜ ìˆìŒì—ë„ ì™œ Update ì¿¼ë¦¬ê°€ ì¶”ê°€ë¡œ ë°œìƒí•˜ëŠ”ì§€ ì˜ì•„í–ˆìŠµë‹ˆë‹¤.</p>\n<p>ê·¸ê²ƒë„ Insert ì¿¼ë¦¬ì™€ Update ì¿¼ë¦¬ë¬¸ì˜ ê°œìˆ˜ë„ ê°ê° 2ê°œì”©ìœ¼ë¡œ ë™ì¼í–ˆìŠµë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">&#39;ê²°ê³¼ë§Œ ì˜ ë™ì‘í•˜ë©´ ë˜ì§€ ì•Šë‚˜?&#39;</code></p>\n<p>ë¼ë©° ê°€ë³ê²Œ ë„˜ê¸¸ ìˆ˜ëŠ” ì—†ëŠ” ë¬¸ì œë¼ê³  ìƒê°í•©ë‹ˆë‹¤.</p>\n<p>ì™œëƒí•˜ë©´, DBì— ìš”ì²­í•˜ëŠ” ì¿¼ë¦¬ê°€ ê²°êµ­ì—” 2ë°°ê°€ ë˜ì—ˆë‹¤ëŠ” ì†Œë¦¬ì´ê³  ê¸°ì¡´ ì„±ëŠ¥ì—ì„œ 2ë°°ë¡œ ê°ì†Œí–ˆë‹¤ëŠ” ì˜ë¯¸ì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>\n<h2 id=\"ë°œìƒ-ì›ì¸\" style=\"position:relative;\"><a href=\"#%EB%B0%9C%EC%83%9D-%EC%9B%90%EC%9D%B8\" aria-label=\"ë°œìƒ ì›ì¸ permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë°œìƒ ì›ì¸?</h2>\n<p>ê·¸ë ‡ë‹¤ë©´ ìœ„ì™€ ê°™ì€ ì´ìŠˆê°€ ë°œìƒë˜ëŠ” ì›ì¸ì€ ë­˜ê¹Œ?</p>\n<p>ì´ëŸ¬í•œ ì´ìœ ëŠ” <code class=\"language-text\">1:N</code> ê´€ê³„ê°€ <code class=\"language-text\">ë‹¨ë°©í–¥</code>ì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">Rating</code> ì—”í‹°í‹°ì— <code class=\"language-text\">reviewId</code> ì»¬ëŸ¼ì´ ì¶”ê°€ë˜ê¸°ëŠ” í–ˆì§€ë§Œ, ë‹¨ë°©í–¥ì´ê¸° ë•Œë¬¸ì— <code class=\"language-text\">Rating</code>ì€ <code class=\"language-text\">Review</code>ì˜ ì¡´ì¬ë¥¼ ëª¨ë¦…ë‹ˆë‹¤.</p>\n<p>ê·¸ë˜ì„œ ê°œë³„ í–‰ ë‹¨ìœ„ë¡œëŠ” <code class=\"language-text\">reviewId</code>ê°€ ì—†ëŠ” ì±„ë¡œ <code class=\"language-text\">Rating</code> í…Œì´ë¸”ì— Insertë˜ê³  ë¨¼ì € DBì— ì €ì¥ëœ ì´í›„ Updateë¥¼ í†µí•´ì„œ <code class=\"language-text\">reviewId</code>ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.</p>\n<h2 id=\"ê·¸ë ‡ë‹¤ë©´-í•´ê²°-ë°©ë²•ì€\" style=\"position:relative;\"><a href=\"#%EA%B7%B8%EB%A0%87%EB%8B%A4%EB%A9%B4-%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95%EC%9D%80\" aria-label=\"ê·¸ë ‡ë‹¤ë©´ í•´ê²° ë°©ë²•ì€ permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê·¸ë ‡ë‹¤ë©´ í•´ê²° ë°©ë²•ì€?</h2>\n<p>RDBì™€ ë™ì¼í•œ ë™ì‘ì„ ì›í•œë‹¤ë©´ JPA ì—”í‹°í‹° ê°„ì˜ ê´€ê³„ë¥¼ <code class=\"language-text\">1:N ë‹¨ë°©í–¥</code> ë§¤í•‘ì´ ì•„ë‹Œ <code class=\"language-text\">1:N ì–‘ë°©í–¥</code> ë§¤í•‘ìœ¼ë¡œ ë³€ê²½ì‹œì¼œì•¼í•©ë‹ˆë‹¤.</p>\n<p><strong>Review ì—”í‹°í‹°</strong></p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Review</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span>IDENTITY<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> reviewId<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@ManyToOne</span><span class=\"token punctuation\">(</span>fetch <span class=\"token operator\">=</span> <span class=\"token class-name\">FetchType</span><span class=\"token punctuation\">.</span>LAZY<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JoinColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"reviewerId\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">User</span> reviewer<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@ManyToOne</span><span class=\"token punctuation\">(</span>fetch <span class=\"token operator\">=</span> <span class=\"token class-name\">FetchType</span><span class=\"token punctuation\">.</span>LAZY<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JoinColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"targetId\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">User</span> target<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// mappedBy ì¶”ê°€, ì¡°ì¸ ì»¬ëŸ¼ ì‚­ì œ</span>\n    <span class=\"token annotation punctuation\">@OneToMany</span><span class=\"token punctuation\">(</span>mappedBy <span class=\"token operator\">=</span> <span class=\"token string\">\"review\"</span><span class=\"token punctuation\">,</span> cascade <span class=\"token operator\">=</span> <span class=\"token class-name\">CascadeType</span><span class=\"token punctuation\">.</span>ALL<span class=\"token punctuation\">,</span> orphanRemoval <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Rating</span><span class=\"token punctuation\">></span></span> rating<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">Review</span> <span class=\"token function\">of</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">User</span> reviewer<span class=\"token punctuation\">,</span> <span class=\"token class-name\">User</span> target<span class=\"token punctuation\">,</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Rating</span><span class=\"token punctuation\">></span></span> rating<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Review</span><span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">reviewer</span><span class=\"token punctuation\">(</span>reviewer<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">target</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">rating</span><span class=\"token punctuation\">(</span>rating<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>Rating ì—”í‹°í‹°</strong></p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Rating</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Id</span>\n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy <span class=\"token operator\">=</span> <span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span>IDENTITY<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Long</span> ratingId<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Column</span><span class=\"token punctuation\">(</span>nullable <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> length <span class=\"token operator\">=</span> <span class=\"token number\">45</span><span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@Enumerated</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">EnumType</span><span class=\"token punctuation\">.</span>STRING<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Content</span> content<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Rating ì—”í‹°í‹°ì— Review í•„ë“œë¥¼ ì¶”ê°€ (ì–‘ë°©í–¥ ì—°ê²°)</span>\n    <span class=\"token annotation punctuation\">@ManyToOne</span><span class=\"token punctuation\">(</span>fetch <span class=\"token operator\">=</span> <span class=\"token class-name\">FetchType</span><span class=\"token punctuation\">.</span>LAZY<span class=\"token punctuation\">)</span>\n    <span class=\"token annotation punctuation\">@JoinColumn</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"reviewId\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Review</span> review<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// ìˆ˜ì •</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">Rating</span> <span class=\"token function\">of</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Content</span> content<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Review</span> review<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span> \n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Rating</span><span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">content</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">review</span><span class=\"token punctuation\">(</span>review<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>ì‹¤í–‰ë˜ëŠ” ì„œë¹„ìŠ¤ ì½”ë“œ</strong></p>\n<div class=\"gatsby-code-title\">Java</div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token comment\">/**\n* íŠ¹ì • ì‚¬ìš©ìì—ê²Œ ë¦¬ë·°í•˜ê¸°\n* @param reviewerId : ë¦¬ë·° í•˜ëŠ” ì‚¬ìš©ì ID (í˜„ì¬ ì‚¬ìš©ì)\n* @param targetId : ë¦¬ë·° í•  ì‚¬ìš©ì ID\n* @param reviewDto : ë¦¬ë·° ë‚´ìš© DTO\n*/</span>\n<span class=\"token annotation punctuation\">@Transactional</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">review</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> reviewerId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Long</span> targetId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">ReviewRequest</span> reviewDto<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">User</span> reviewer <span class=\"token operator\">=</span> userRepository<span class=\"token punctuation\">.</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>reviewerId<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UserNotFoundException</span><span class=\"token operator\">::</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">User</span> target <span class=\"token operator\">=</span> userRepository<span class=\"token punctuation\">.</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>targetId<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UserNotFoundException</span><span class=\"token operator\">::</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">Optional</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Review</span><span class=\"token punctuation\">></span></span> optional <span class=\"token operator\">=</span> reviewQueryRepository<span class=\"token punctuation\">.</span><span class=\"token function\">exists</span><span class=\"token punctuation\">(</span>reviewerId<span class=\"token punctuation\">,</span> targetId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>optional<span class=\"token punctuation\">.</span><span class=\"token function\">isPresent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ReviewDuplicatedException</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">Review</span> review <span class=\"token operator\">=</span> <span class=\"token class-name\">Review</span><span class=\"token punctuation\">.</span><span class=\"token function\">of</span><span class=\"token punctuation\">(</span>reviewer<span class=\"token punctuation\">,</span> target<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Rating</span><span class=\"token punctuation\">></span></span> ratingList <span class=\"token operator\">=</span> reviewDto<span class=\"token punctuation\">.</span><span class=\"token function\">getRatingList</span><span class=\"token punctuation\">(</span>review<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ìˆ˜ì •</span>\n    ratingList<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>rating <span class=\"token operator\">-></span> review<span class=\"token punctuation\">.</span><span class=\"token function\">getRating</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>rating<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    reviewRepository<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>review<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4 id=\"ì‹¤í–‰-ê²°ê³¼-1\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%ED%96%89-%EA%B2%B0%EA%B3%BC-1\" aria-label=\"ì‹¤í–‰ ê²°ê³¼ 1 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì‹¤í–‰ ê²°ê³¼</h4>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0db50347a22a8795f5973150e1a350fe/2cefc/solution.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.57446808510639%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABM0lEQVQozz1QW3KDMBDjQoWmkwkvvzA2JgRC0namvf9FVK0n9EOzXq1Wll30SiHGCGMMvPe5DsMA59x/L1VwcDIfxxGBe4dWejkXfd9j2zaklLCuK67XK5ZlyZimCV3XZVOBtTYva61zL2fFQOJxaArFoRiGELJZZBXzRDOpIgq8XRJIOnlNTkedXHgkFF7mRd22ObrjIMQJXpZl6cXVTYtL06Bl0o5Jap6Fa9oODTnhW3o05CVt4Y3G7+cTDz5xS7yx75AGh2ANRs4C4ciNWmXo+pI5mXvFp9LkMJWvKHbTY58TZgqWwWLikmB2BpNRWINHooHg5l3W5Rk17nKGrt5QVhUqoixLFF9O4+e+YqP4mSJW1jtNHlMkAr6XGTdnc93jiOeLj6qDPX9kw/fTCacX/gAvuvVdyzXrngAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"í•´ê²° ê²°ê³¼\"\n        title=\"í•´ê²° ê²°ê³¼\"\n        src=\"/static/0db50347a22a8795f5973150e1a350fe/1d69c/solution.png\"\n        srcset=\"/static/0db50347a22a8795f5973150e1a350fe/4dcb9/solution.png 188w,\n/static/0db50347a22a8795f5973150e1a350fe/5ff7e/solution.png 375w,\n/static/0db50347a22a8795f5973150e1a350fe/1d69c/solution.png 750w,\n/static/0db50347a22a8795f5973150e1a350fe/78797/solution.png 1125w,\n/static/0db50347a22a8795f5973150e1a350fe/2cefc/solution.png 1400w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"ê²°ë¡ \" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EB%A1%A0\" aria-label=\"ê²°ë¡  permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê²°ë¡ </h2>\n<p><code class=\"language-text\">1:N ë‹¨ë°©í–¥</code> ë§¤í•‘ì€ ì„¤ì •ë„ ê°„í¸í•˜ê³  ì§ê´€ì ì´ì§€ë§Œ, Updateê°€ ì˜¤ë²„í—¤ë“œë¡œ ì‘ìš©í•©ë‹ˆë‹¤.</p>\n<p><code class=\"language-text\">@OneToMany</code>ë§Œ ë¶™íˆëŠ” <code class=\"language-text\">1:N ë‹¨ë°©í–¥</code> ì¡°ì¸ í…Œì´ë¸” ë°©ì‹ê³¼ <code class=\"language-text\">@JoinColum</code>ë§Œ ë¶™íˆëŠ” <code class=\"language-text\">1:N ë‹¨ë°©í–¥</code> ì¡°ì¸ ì»¬ëŸ¼ ë°©ì‹ ëª¨ë‘ í”¼í•´ì•¼í•©ë‹ˆë‹¤.</p>\n<p>ë”°ë¼ì„œ, 1:Nì—ì„œ Nì´ í° ìƒí™© ë˜ëŠ” ëª¨ë“  ìƒí™©ì—ì„œ ì˜¤ë²„í—¤ë“œê°€ ì—†ëŠ” <code class=\"language-text\">1:N ì–‘ë°©í–¥</code> ë§¤í•‘ì„ ì‚¬ìš©í•˜ëŠ”ê²Œ ì„±ëŠ¥ì— ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤ !</p>","tableOfContents":"<ul>\n<li><a href=\"/category/blog/spring-jpa-one-to-many-save-issue/#%EA%B0%9C%EC%9A%94\">ê°œìš”</a></li>\n<li>\n<p><a href=\"/category/blog/spring-jpa-one-to-many-save-issue/#%ED%98%84%EC%9E%AC-%EC%9D%B4%EC%8A%88-%EB%B0%9C%EC%83%9D-%EC%83%81%ED%99%A9\">í˜„ì¬ ì´ìŠˆ ë°œìƒ ìƒí™©</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/blog/spring-jpa-one-to-many-save-issue/#%EC%8B%A4%ED%96%89-%EA%B2%B0%EA%B3%BC\">ì‹¤í–‰ ê²°ê³¼</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"/category/blog/spring-jpa-one-to-many-save-issue/#%EB%B0%9C%EC%83%9D-%EC%9B%90%EC%9D%B8\">ë°œìƒ ì›ì¸?</a></li>\n<li>\n<p><a href=\"/category/blog/spring-jpa-one-to-many-save-issue/#%EA%B7%B8%EB%A0%87%EB%8B%A4%EB%A9%B4-%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95%EC%9D%80\">ê·¸ë ‡ë‹¤ë©´ í•´ê²° ë°©ë²•ì€?</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/category/blog/spring-jpa-one-to-many-save-issue/#%EC%8B%A4%ED%96%89-%EA%B2%B0%EA%B3%BC-1\">ì‹¤í–‰ ê²°ê³¼</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"/category/blog/spring-jpa-one-to-many-save-issue/#%EA%B2%B0%EB%A1%A0\">ê²°ë¡ </a></li>\n</ul>","frontmatter":{"title":"[Spring JPA] 1:N ê´€ê³„ ì—”í‹°í‹° saveì‹œ update ì¿¼ë¦¬ê°€ ì¶”ê°€ë¡œ ë°œìƒí•˜ëŠ” ì´ìŠˆ","description":"","date":"2020.09.25","emoji":"ğŸ’­","category":"blog"}}},"pageContext":{"slug":"/category/blog/spring-jpa-one-to-many-save-issue/","relatedPosts":[{"node":{"fields":{"slug":"/category/blog/spring/redis/spring-data-redis-version-issue/"},"frontmatter":{"title":"[Spring Redis] Spring Boot 2.3.2.RELEASE ë²„ì „ Redis ì´ìŠˆ","date":"2020.11.20","emoji":"ğŸš€","category":"blog"}}},{"node":{"fields":{"slug":"/category/blog/spring-transactional-precautions/"},"frontmatter":{"title":"[Spring] @Transactional ì‚¬ìš© ì‹œ ì£¼ì˜ì ê³¼ JPQL ì£¼ì˜ì ","date":"2020.11.14","emoji":"ğŸš§","category":"blog"}}},{"node":{"fields":{"slug":"/category/blog/aws-eb-deploy/"},"frontmatter":{"title":"[AWS EB] AWS Elastic Beanstalkë¡œ ì„œë²„ ë°°í¬ í•˜ê¸°","date":"2020.09.02","emoji":"ğŸš€","category":"blog"}}},{"node":{"fields":{"slug":"/category/blog/http-post-redirect-to-get/"},"frontmatter":{"title":"ì™œ ë¦¬ë‹¤ì´ë ‰íŠ¸ì‹œ HTTP ë©”ì†Œë“œë“¤ì€ GET ë©”ì„œë“œë¡œ ë¦¬ë‹¤ì´ë ‰ì…˜ ë ê¹Œ?","date":"2020.08.27","emoji":"â”","category":"blog"}}}]}}}